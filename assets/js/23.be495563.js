(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{365:function(t,a,s){"use strict";s.r(a);var e=s(34),n=Object(e.a)({},function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"command-line-interface"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#command-line-interface","aria-hidden":"true"}},[t._v("#")]),t._v(" Command-Line Interface")]),t._v(" "),s("h4",{attrs:{id:"description"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#description","aria-hidden":"true"}},[t._v("#")]),t._v(" Description")]),t._v(" "),s("p",[t._v("ImunifyAV(+) command-line interface (CLI) makes working with ImunifyAV(+) basics and features from your terminal even simpler.")]),t._v(" "),s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("Note")]),s("p",[t._v("CLI commands are available only for cPanel and DirectAdmin control panels. Plesk and ISPmanager CLI support is coming soon.")])]),s("h4",{attrs:{id:"usage"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#usage","aria-hidden":"true"}},[t._v("#")]),t._v(" Usage")]),t._v(" "),s("p",[t._v("For access to the ImunifyAV agent features from the command-line interface, use the following command:")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus\n")])])]),s("p",[t._v("Basic usage:")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus [command] [--option1] [--option2]... \n")])])]),s("h4",{attrs:{id:"options"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#options","aria-hidden":"true"}},[t._v("#")]),t._v(" Options")]),t._v(" "),s("p",[t._v("The following options are available for all commands.")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th"),t._v(" "),s("th")])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("code",[t._v("-h")]),t._v(", "),s("code",[t._v("--help")])]),t._v(" "),s("td",[t._v("show this help message and exit")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("--console-log-level {ERROR,WARNING,INFO,DEBUG}")])]),t._v(" "),s("td",[t._v("level of logging input to the console")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("--json")])]),t._v(" "),s("td",[t._v("returns data in JSON format")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("--verbose, -v")])]),t._v(" "),s("td",[t._v("allows to return data in good-looking view if option "),s("code",[t._v("--json")]),t._v(" is used")])])])]),t._v(" "),s("h4",{attrs:{id:"examples"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#examples","aria-hidden":"true"}},[t._v("#")]),t._v(" Examples")]),t._v(" "),s("ol",[s("li",[t._v("This command allows to show help for the "),s("code",[t._v("start")]),t._v(" command:"),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus start [-h]\n")])])])])]),t._v(" "),s("p",[s("strong",[t._v("Available commands:")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th"),t._v(" "),s("th")])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("RouterLink",{attrs:{to:"/cli/#add-sudouser"}},[s("code",[t._v("add-sudouser")])])],1),t._v(" "),s("td",[t._v("add a user with root privileges")])]),t._v(" "),s("tr",[s("td",[s("RouterLink",{attrs:{to:"/cli/#checkdb"}},[s("code",[t._v("checkdb")])])],1),t._v(" "),s("td",[t._v("check database integrity")])]),t._v(" "),s("tr",[s("td",[s("RouterLink",{attrs:{to:"/cli/#check-domains"}},[s("code",[t._v("check-domains")])])],1),t._v(" "),s("td",[t._v("send domain list check")])]),t._v(" "),s("tr",[s("td",[s("RouterLink",{attrs:{to:"/cli/#config-update"}},[s("code",[t._v("config update")])])],1),t._v(" "),s("td",[t._v("update configuration file via CLI")])]),t._v(" "),s("tr",[s("td",[s("RouterLink",{attrs:{to:"/cli/#delete-sudouser"}},[s("code",[t._v("delete-sudouser")])])],1),t._v(" "),s("td",[t._v("remove a user with root privileges")])]),t._v(" "),s("tr",[s("td",[s("RouterLink",{attrs:{to:"/cli/#doctor"}},[s("code",[t._v("doctor")])])],1),t._v(" "),s("td",[t._v("collect info about the system and send it to ImunifyAV(+)")])]),t._v(" "),s("tr",[s("td",[s("RouterLink",{attrs:{to:"/cli/#infected-domains"}},[s("code",[t._v("infected-domains")])])],1),t._v(" "),s("td",[t._v("returns infected domain list")])]),t._v(" "),s("tr",[s("td",[s("RouterLink",{attrs:{to:"/cli/#feature-management"}},[s("code",[t._v("feature-management")])])],1),t._v(" "),s("td",[t._v("manage ImunifyAV(+) features available for users")])]),t._v(" "),s("tr",[s("td",[s("RouterLink",{attrs:{to:"/cli/#hooks"}},[s("code",[t._v("hooks")])])],1),t._v(" "),s("td",[t._v("hooks-related operations")])]),t._v(" "),s("tr",[s("td",[s("RouterLink",{attrs:{to:"/cli/#malware"}},[s("code",[t._v("malware")])])],1),t._v(" "),s("td",[t._v("malware-related operations")])]),t._v(" "),s("tr",[s("td",[s("RouterLink",{attrs:{to:"/cli/#notifications-config"}},[s("code",[t._v("notifications-config")])])],1),t._v(" "),s("td",[t._v("allows to update notifications in the configuration file via CLI")])]),t._v(" "),s("tr",[s("td",[s("RouterLink",{attrs:{to:"/cli/#register"}},[s("code",[t._v("register")])])],1),t._v(" "),s("td",[t._v("register the agent")])]),t._v(" "),s("tr",[s("td",[s("RouterLink",{attrs:{to:"/cli/#rstatus"}},[s("code",[t._v("rstatus")])])],1),t._v(" "),s("td",[t._v("send a query to server to the check if the license is valid")])]),t._v(" "),s("tr",[s("td",[s("RouterLink",{attrs:{to:"/cli/#start"}},[s("code",[t._v("start")])])],1),t._v(" "),s("td",[t._v("start the agent")])]),t._v(" "),s("tr",[s("td",[s("RouterLink",{attrs:{to:"/cli/#submit-false-positive-false-negative"}},[s("code",[t._v("submit false-positive/false-negative")])])],1),t._v(" "),s("td",[t._v("allows to submit a file as false positive/false negative")])]),t._v(" "),s("tr",[s("td",[s("RouterLink",{attrs:{to:"/cli/#unregister"}},[s("code",[t._v("unregister")])])],1),t._v(" "),s("td",[t._v("unregister the agent")])]),t._v(" "),s("tr",[s("td",[s("RouterLink",{attrs:{to:"/cli/#update"}},[s("code",[t._v("update")])])],1),t._v(" "),s("td",[t._v("update malware signatures")])]),t._v(" "),s("tr",[s("td",[s("RouterLink",{attrs:{to:"/cli/#update-license"}},[s("code",[t._v("update-license")])])],1),t._v(" "),s("td",[t._v("force license update")])]),t._v(" "),s("tr",[s("td",[s("RouterLink",{attrs:{to:"/cli/#version"}},[s("code",[t._v("version")])])],1),t._v(" "),s("td",[t._v("show version")])])])]),t._v(" "),s("h2",{attrs:{id:"add-sudouser"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#add-sudouser","aria-hidden":"true"}},[t._v("#")]),t._v(" Add-sudouser")]),t._v(" "),s("p",[t._v("This command adds a user with root privileges to the server.")]),t._v(" "),s("p",[s("strong",[t._v("Usage:")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus add-sudouser <userID> [--optional arguments]\n")])])]),s("p",[s("strong",[t._v("Example:")])]),t._v(" "),s("p",[t._v("This command adds the user 11XXX111 with root privileges to the server:")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus add-sudouser 11XXX111\nOK\n")])])]),s("h2",{attrs:{id:"checkdb"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#checkdb","aria-hidden":"true"}},[t._v("#")]),t._v(" Checkdb")]),t._v(" "),s("p",[t._v("Checks database integrity. In case database is corrupt, then this command saves backup copy of the database at "),s("code",[t._v("/var/imunifyav")]),t._v(" and tries to restore integrity of the original database.")]),t._v(" "),s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("Note")]),s("p",[t._v("If this command cannot restore database integrity, then it will destroy the original broken database.")])]),s("p",[s("strong",[t._v("Usage:")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus checkdb [--optional arguments]\n")])])]),s("p",[s("strong",[t._v("Example:")])]),t._v(" "),s("p",[t._v("The following command checks the database integrity:")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus checkdb\n")])])]),s("h2",{attrs:{id:"check-domains"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#check-domains","aria-hidden":"true"}},[t._v("#")]),t._v(" Check-domains")]),t._v(" "),s("p",[t._v("Allows to send domains list to check on ImunifyAV central server. This command requires cPanel. After domains checked, the results is available via the "),s("code",[t._v("infected-domains")]),t._v(" command.")]),t._v(" "),s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("Note")]),s("p",[s("code",[t._v("check-domains")]),t._v(" command may take a few minutes to complete.")])]),s("p",[s("strong",[t._v("Usage")]),t._v(":")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus check-domains [--optional arguments]\n")])])]),s("p",[s("strong",[t._v("Example:")])]),t._v(" "),s("p",[t._v("The following command sends the domains list for a check to the Imunify central server. In case there are no infected domains found on the server, you will see no output. If there are any, you will get the following output:")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus check-domains\n'domain1.com'\n'domain2.com'\n")])])]),s("h2",{attrs:{id:"config-update"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#config-update","aria-hidden":"true"}},[t._v("#")]),t._v(" Config update")]),t._v(" "),s("p",[t._v("Allows to update configuration file via CLI.")]),t._v(" "),s("p",[s("strong",[t._v("Usage:")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus config update [configuration options]\n")])])]),s("p",[t._v("You can find instructions on how to apply configuration changes from CLI "),s("RouterLink",{attrs:{to:"/cli/#how-to-apply-changes-from-cli"}},[t._v("here")]),t._v(" and configuration options can be taken from the "),s("code",[t._v("/etc/sysconfig/imunify360/imunify360.config")]),t._v(" file.")],1),t._v(" "),s("p",[s("strong",[t._v("Example:")])]),t._v(" "),s("p",[t._v("Set the "),s("code",[t._v("MALWARE_SCAN_INTENSITY.cpu = 5")]),t._v(" configuration option from a command line:")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('imunify-antivirus config update \'{"MALWARE_SCAN_INTENSITY": {"cpu": 5}}\'\n')])])]),s("p",[t._v("The successful output should display the configuration file content.")]),t._v(" "),s("h2",{attrs:{id:"delete-sudouser"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#delete-sudouser","aria-hidden":"true"}},[t._v("#")]),t._v(" Delete-sudouser")]),t._v(" "),s("p",[t._v("This command removes a user with root privileges from the server.")]),t._v(" "),s("p",[s("strong",[t._v("Usage:")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus delete-sudouser <userID> [--optional arguments]\n")])])]),s("p",[s("strong",[t._v("Example:")])]),t._v(" "),s("p",[t._v("The following command removes the user 11XXX111 with root privileges from the server.")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus delete-sudouser 11XXX111\nOK\n")])])]),s("h2",{attrs:{id:"doctor"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#doctor","aria-hidden":"true"}},[t._v("#")]),t._v(" Doctor")]),t._v(" "),s("p",[t._v("This command collects information about ImunifyAV state, generates the report and sends it to the ImunifyAV Support Team. This command can be used in case of any troubles or issues with ImunifyAV. This command will generate a key to be sent to the ImunifyAV Support Team. With that key the ImunifyAV Support Team can help with any problem as fast as possible.")]),t._v(" "),s("p",[s("strong",[t._v("Usage:")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus doctor [--optional arguments]\n")])])]),s("p",[t._v("The successful output will contain the unique set of symbols, for example:")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus doctor\nPlease, provide this key:\nSSXX11xXXXxxxxXX.1a1bcd1e-222f-33g3-hi44-5551k5lmn555\nto Imunify360 Support Team\n")])])]),s("h2",{attrs:{id:"infected-domains"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#infected-domains","aria-hidden":"true"}},[t._v("#")]),t._v(" Infected-domains")]),t._v(" "),s("p",[t._v("Allows to retrieve infected domains list.")]),t._v(" "),s("p",[s("strong",[t._v("Usage")]),t._v(":")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus infected-domains [-h] [--optional arguments]\n")])])]),s("p",[t._v("Optional arguments for "),s("code",[t._v("list")]),t._v(":")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th"),t._v(" "),s("th")])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("code",[t._v("--limit")])]),t._v(" "),s("td",[t._v("Limits the output with the specified number of domains."),s("br"),t._v("Must be a number greater than zero. By default, equals 100.")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("--offset")])]),t._v(" "),s("td",[t._v("Offset for pagination. By default, equals 0.")])])])]),t._v(" "),s("p",[s("strong",[t._v("Example:")])]),t._v(" "),s("p",[t._v("The following command displays the results of the "),s("code",[t._v("check-domains")]),t._v(" command. In case there are no infected domains found on the server, you will see no output. If there are any, you will get the following output:")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus infected-domains\n'domain1.com'\n'domain2.com'\n")])])]),s("h2",{attrs:{id:"feature-management"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#feature-management","aria-hidden":"true"}},[t._v("#")]),t._v(" Feature-management")]),t._v(" "),s("p",[t._v("Allows to manage ImunifyAV features available for users.")]),t._v(" "),s("p",[s("strong",[t._v("Usage:")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus feature-management [command] [--optional argument]...\n")])])]),s("p",[s("code",[t._v("Command")]),t._v(" can be one of the following:")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th"),t._v(" "),s("th")])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("code",[t._v("defaults")])]),t._v(" "),s("td",[t._v("show the default value for each feature that is applied for newly created user")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("disable")])]),t._v(" "),s("td",[t._v("disable a feature for some or all users")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("enable")])]),t._v(" "),s("td",[t._v("enable a feature for some or all users")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("get")])]),t._v(" "),s("td",[t._v("obtains the status of all available features for a "),s("code",[t._v("USER")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("list")])]),t._v(" "),s("td",[t._v("list all available features")])])])]),t._v(" "),s("p",[s("code",[t._v("Optional argument")]),t._v(" for the "),s("code",[t._v("enable/disable")]),t._v(" commands can be one of the following:")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th"),t._v(" "),s("th")])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("[--feature av]")])])]),t._v(" "),s("td",[t._v("enable/disable "),s("span",{staticClass:"notranslate"},[t._v("Malware Cleanup")])])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("[--feature proactive]")])])]),t._v(" "),s("td",[t._v("enable/disable "),s("span",{staticClass:"notranslate"},[t._v("Proactive Defense")])])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("[--users [USERS [USERS ...]]]")])]),t._v(" "),s("td",[t._v("specifies the list of users which will be affected, otherwise the default value will be changed")])])])]),t._v(" "),s("p",[t._v("The mandatory argument for the "),s("code",[t._v("get")]),t._v(" command:")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th"),t._v(" "),s("th")])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("code",[t._v("[--user USER]")])]),t._v(" "),s("td",[t._v("specifies a user name to obtain the status of features for")])])])]),t._v(" "),s("p",[s("strong",[t._v("Example:")])]),t._v(" "),s("p",[t._v("The following command enables malware cleanup feature for the "),s("code",[t._v("user1")]),t._v(". If the operation is successful for the user "),s("code",[t._v("user1")]),t._v(", you will receive the following reply:")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus feature-management enable --feature av --users user1\nfailed: []\nsucceeded:\n- user1\n")])])]),s("h2",{attrs:{id:"hooks"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#hooks","aria-hidden":"true"}},[t._v("#")]),t._v(" Hooks "),s("Badge",{attrs:{text:"Deprecated",type:"warning"}})],1),t._v(" "),s("div",{staticClass:"danger custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("Warning!")]),s("p",[t._v("You can use a new notification system via "),s("RouterLink",{attrs:{to:"/cli/#notifications-config"}},[t._v("CLI")]),t._v(".")],1)]),s("p",[t._v("You can read more about hooks "),s("RouterLink",{attrs:{to:"/imunifyav/#hooks-cli"}},[t._v("here")]),t._v(".")],1),t._v(" "),s("p",[t._v("This command allows to manage hooks.")]),t._v(" "),s("p",[s("strong",[t._v("Usage:")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus hook [command] --event [event_name|all] [--path </path/to/hook_script>]\n")])])]),s("p",[s("code",[t._v("command")]),t._v(" can be one of the following:")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th"),t._v(" "),s("th")])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("code",[t._v("add")])]),t._v(" "),s("td",[t._v("register a new event handler")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("delete")])]),t._v(" "),s("td",[t._v("unregister existing event handler")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("list")])]),t._v(" "),s("td",[t._v("show existing event handlers")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("add-native")])]),t._v(" "),s("td",[t._v("register a new native event handler")])])])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th"),t._v(" "),s("th")])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("code",[t._v("--event [event_name|all]")])]),t._v(" "),s("td",[t._v("defines a particular event that invokes"),s("br"),t._v("a registered handler as opposed to all keyword")])]),t._v(" "),s("tr",[s("td",[s("code",[t._v("--path </path/to/hook_script>")])]),t._v(" "),s("td",[t._v("shall contain a valid path to a handler of the event,"),s("br"),t._v("it shall be any executable or Python Native event handlers"),s("br"),t._v("that agent will run upon a registered event")])])])]),t._v(" "),s("p",[s("strong",[t._v("Example:")])]),t._v(" "),s("p",[t._v("The following command shows existing event handlers. If you have any hooks configured, the output will include something similar to this:")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus hook list --event all\nEvent: malware-detected, Path: /root/directory/IMAVscannereventhooks/malware_detected.py\n")])])]),s("h2",{attrs:{id:"login"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#login","aria-hidden":"true"}},[t._v("#")]),t._v(" Login")]),t._v(" "),s("p",[t._v("Allows to get a token which can be used for authentication in stand-alone Imunify UI.")]),t._v(" "),s("p",[s("strong",[t._v("Usage")]),t._v(":")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus login [command] [--optional arguments]\n")])])])]),t._v(" "),s("p",[s("span",{staticClass:"notranslate"},[s("code",[t._v("command")])]),t._v(" can be one of the following:")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th"),t._v(" "),s("th")])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("get")])])]),t._v(" "),s("td",[t._v("returns a token for USERNAME (must be executed by root)")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("pam")])])]),t._v(" "),s("td",[t._v("uses PAM to check the provided credential and returns a token for USERNAME if PASSWORD is correct")])])])]),t._v(" "),s("p",[t._v("Optional arguments for "),s("span",{staticClass:"notranslate"},[s("code",[t._v("get")])]),t._v(":")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th")])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("--username USERNAME")])])])])])]),t._v(" "),s("p",[t._v("Optional arguments for "),s("span",{staticClass:"notranslate"},[s("code",[t._v("pam")])]),t._v(":")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th")])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("--username USERNAME")])])])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("--password PASSWORD")])])])])])]),t._v(" "),s("p",[s("strong",[t._v("Example")]),t._v(":")]),t._v(" "),s("p",[t._v("You can use the "),s("span",{staticClass:"notranslate"},[s("code",[t._v("login get")])]),t._v(" command to implement your own authorization mechanism for stand-alone ImunifyAV.\nFor example, you can generate tokens for users which are already authorized in your system/panel, and redirect to stand-alone Imunify UI with "),s("span",{staticClass:"notranslate"},[s("code",[t._v("?token=<TOKEN>")])]),t._v(" in URL. (You can also set it in localStorage: "),s("span",{staticClass:"notranslate"},[s("code",[t._v("localStorage.setItem('I360_AUTH_TOKEN', '<TOKEN>');")])]),t._v(")")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus login get --username my-user1\neyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJleHAiOjE2MDAyNDQwMTAuMDk5MzE5LCJ1c2VyX3R5cGUiOiJjbGllbnQiLCJ1c2VybmFtZSI6ImNsdGVzdCJ9.V_Q03hYw4dNLX5cewEb_h46hOw96KWBWP0E0ChbP3dA\n")])])])]),t._v(" "),s("h2",{attrs:{id:"malware"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#malware","aria-hidden":"true"}},[t._v("#")]),t._v(" Malware")]),t._v(" "),s("p",[t._v("Allows to manage malware options.")]),t._v(" "),s("p",[s("strong",[t._v("Usage")]),t._v(":")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus malware [command] [--optional arguments]\n")])])])]),t._v(" "),s("p",[t._v("Available commands:")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th"),t._v(" "),s("th")])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("ignore")])])]),t._v(" "),s("td",[t._v("malware Ignore List operations")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("malicious")])])]),t._v(" "),s("td",[t._v("malware Malicious List operations")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("on-demand")])])]),t._v(" "),s("td",[t._v("on-demand Scanner operations")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("suspicious")])])]),t._v(" "),s("td",[t._v("malware Suspicious List operations")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("cleanup status")])])]),t._v(" "),s("td",[t._v("show the status of the cleanup process")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("history list")])])]),t._v(" "),s("td",[t._v("lists the complete history of all malware-related incidents/actions (optional arguments available)")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("rebuild patterns")])])]),t._v(" "),s("td",[t._v("allows to save changes after editing the excluded patterns for Malware Scanner. See details "),s("a",{attrs:{href:"https://docs.imunify360.com/faq_and_known_issues/#_22-how-to-edit-watched-and-excluded-patterns-for-malware-scanner",target:"_blank",rel:"noopener noreferrer"}},[t._v("here"),s("OutboundLink")],1)])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("user")])])]),t._v(" "),s("td",[t._v("allows to perform Malware Scanner operations for a user")])])])]),t._v(" "),s("p",[t._v("Optional arguments:")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th"),t._v(" "),s("th")])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("--limit LIMIT")])])]),t._v(" "),s("td",[t._v("Limits the output with the specified number of domains."),s("br"),t._v("Must be a number greater than zero. By default, equals 100.")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("--offset OFFSET")])])]),t._v(" "),s("td",[t._v("Offset for pagination. By default, equals 0.")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("--since SINCE")])])]),t._v(" "),s("td",[t._v("Start date.")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("--to TO")])])]),t._v(" "),s("td",[t._v("End date.")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("--user USER")])])]),t._v(" "),s("td",[t._v("Returns results for a chosen user.")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("--order-by [ORDER_BY [ORDER_BY ...]]")])])]),t._v(" "),s("td",[t._v("Sorting order.")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("--by-status [BY_STATUS [BY_STATUS ...]]")])])]),t._v(" "),s("td",[t._v("Return items with selected status.")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("--by-scan-id BY_SCAN_ID")])])]),t._v(" "),s("td",[t._v("Return items with selected ID.")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("--items ITEMS")])])]),t._v(" "),s("td",[t._v("Return selected items.")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("--search SEARCH")])])]),t._v(" "),s("td",[t._v("Search query.")])])])]),t._v(" "),s("p",[s("span",{staticClass:"notranslate"},[s("code",[t._v("action")])]),t._v(" is the second positional argument for "),s("span",{staticClass:"notranslate"},[s("code",[t._v("ignore")])]),t._v(" and can be one of the following:")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th"),t._v(" "),s("th")])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("add")])])]),t._v(" "),s("td",[t._v("add file PATHS to the "),s("span",{staticClass:"notranslate"},[t._v("Ignore List")])])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("delete")])])]),t._v(" "),s("td",[t._v("delete file PATHS from the "),s("span",{staticClass:"notranslate"},[t._v("Ignore List")])])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("list")])])]),t._v(" "),s("td",[t._v("shows "),s("span",{staticClass:"notranslate"},[t._v("Ignore List")]),t._v(" entries (optional arguments apply)")])])])]),t._v(" "),s("p",[t._v("where PATHS are the absolute paths to files or folders divided by a whitespace.")]),t._v(" "),s("p",[s("span",{staticClass:"notranslate"},[s("code",[t._v("command2")])]),t._v(" is the second positional argument for the "),s("span",{staticClass:"notranslate"},[s("code",[t._v("malicious")])]),t._v(" command and can be one of the following:")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th"),t._v(" "),s("th")])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("cleanup")])])]),t._v(" "),s("td",[t._v("clean up infected ITEMS for a USER")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("cleanup-all")])])]),t._v(" "),s("td",[t._v("clean up all files that have been detected as infected for all users")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("restore-original")])])]),t._v(" "),s("td",[t._v("restore the original (malicious/infected) file to its original location")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("list")])])]),t._v(" "),s("td",[t._v("list malicious/infected files")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("move-to-ignore")])])]),t._v(" "),s("td",[t._v("move a "),s("span",{staticClass:"notranslate"},[t._v("Malicious List")]),t._v(" entry to the (malware) "),s("span",{staticClass:"notranslate"},[t._v("Ignore List")])])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("remove-from-list")])])]),t._v(" "),s("td",[t._v("remove malicious/infected files from the "),s("span",{staticClass:"notranslate"},[t._v("Malicious List")])])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("restore-from-backup")])])]),t._v(" "),s("td",[t._v("restore a clean version of infected file from backup")])])])]),t._v(" "),s("p",[s("span",{staticClass:"notranslate"},[s("code",[t._v("action")])]),t._v(" is the second positional argument for "),s("span",{staticClass:"notranslate"},[s("code",[t._v("on-demand")])]),t._v(" and can be one of the following:")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th"),t._v(" "),s("th")])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("list")])])]),t._v(" "),s("td",[t._v("list all on-demand scans performed")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("start --path PATH")])])]),t._v(" "),s("td",[t._v("starts an on-demand scan for a specified PATH")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("status")])])]),t._v(" "),s("td",[t._v("show the on-demand malware scanner status")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("stop")])])]),t._v(" "),s("td",[t._v("stop on-demand malware scanner process")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("queue put")])])]),t._v(" "),s("td",[t._v("put file PATHS to the queue for on-demand scan")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("queue remove")])])]),t._v(" "),s("td",[t._v("remove scans from the queue for on-demand scan")])])])]),t._v(" "),s("p",[t._v("The optional arguments for "),s("span",{staticClass:"notranslate"},[s("code",[t._v("on-demand start")])]),t._v(" and "),s("span",{staticClass:"notranslate"},[s("code",[t._v("on-demand queue put")])]),t._v(" are:")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th")])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("--ignore-mask IGNORE_MASK")])])])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("--follow-symlinks")])])])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("--no-follow-symlinks")])])])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("--file-mask FILE_MASK")])])])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("--intensity-cpu {1 to 7}")])]),t._v(" 1 means the lowest intensity, 7 means the highest intensity")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("--intensity-io {1 to 7}")])]),t._v(" 1 means the lowest intensity, 7 means the highest intensity")])])])]),t._v(" "),s("p",[s("span",{staticClass:"notranslate"},[s("code",[t._v("action")])]),t._v(" is the second positional argument for "),s("span",{staticClass:"notranslate"},[s("code",[t._v("suspicious")])]),t._v(" and can be one of:")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th"),t._v(" "),s("th")])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("list")])])]),t._v(" "),s("td",[t._v("obtain the list of "),s("span",{staticClass:"notranslate"},[t._v("Suspicious List")]),t._v(" entries")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("move-to-ignore")])])]),t._v(" "),s("td",[t._v("move a "),s("span",{staticClass:"notranslate"},[t._v("Suspicious List")]),t._v(" entry to the (malware) "),s("span",{staticClass:"notranslate"},[t._v("Ignore List")])])])])]),t._v(" "),s("p",[s("span",{staticClass:"notranslate"},[s("code",[t._v("action")])]),t._v(" is the second positional argument for "),s("span",{staticClass:"notranslate"},[s("code",[t._v("user")])]),t._v(" and can be one of the following:")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th"),t._v(" "),s("th")])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("cleanup USER")])])]),t._v(" "),s("td",[t._v("clean all infected files for a user")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("restore-original USER")])])]),t._v(" "),s("td",[t._v("restore all original files for a user")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("list")])])]),t._v(" "),s("td",[t._v("list all users and their current infection status")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("scan")])])]),t._v(" "),s("td",[t._v("scan all users")])])])]),t._v(" "),s("p",[s("strong",[t._v("Examples")])]),t._v(" "),s("ol",[s("li",[t._v("The following command starts on-demand scanner for the path specified after the "),s("span",{staticClass:"notranslate"},[s("code",[t._v("start")])]),t._v(" command:")])]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus malware on-demand start --path /home/<username>/public_html/\n")])])])]),t._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[t._v("The following command shows the example of the "),s("span",{staticClass:"notranslate"},[s("code",[t._v("ignore-mask")])]),t._v(" usage when you have to scan all "),s("code",[t._v("d*")]),t._v(" folders except for the "),s("span",{staticClass:"notranslate"},[s("code",[t._v("dixon77w.com")])]),t._v(" and "),s("span",{staticClass:"notranslate"},[s("code",[t._v("dunnrrr.com")])]),t._v(":")])]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus malware on-demand start --path='/var/www/vhosts/d*' --ignore-mask='/var/www/vhosts/dixon77w.com/*,/var/www/vhosts/dunnrrr.com/*'\n")])])])]),t._v(" "),s("ol",{attrs:{start:"3"}},[s("li",[t._v("The following command adds on-demand scans for the selected path(s) to the scan queue")])]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('imunify-antivirus malware on-demand queue put "/home/user1/some folder" "/home/user2" --file-mask="*.php"\n')])])])]),t._v(" "),s("ol",{attrs:{start:"4"}},[s("li",[t._v("The following command removes the selected scans from the scan queue")])]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus malware on-demand list        # get scan_ids for the selected scans from the malicious list\nimunify-antivirus malware on-demand queue remove 84f043211dc045ae8e6d641f3b9fdb0a 8c4ee39d4d8f43e296e893940c8e791a\n")])])])]),t._v(" "),s("ol",{attrs:{start:"5"}},[s("li",[t._v("The following command stops the on-demand Malware Scanner process")])]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus malware on-demand stop\n")])])])]),t._v(" "),s("ol",{attrs:{start:"6"}},[s("li",[t._v("The following command stops the on-demand Malware Scanner process and clears the scan queue")])]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus malware on-demand stop --all\n")])])])]),t._v(" "),s("ol",{attrs:{start:"7"}},[s("li",[t._v("The following command shows how to get an extended list of malicious files for a particular user. By default, a limit value equals to 50")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus malware malicious list --user cltest --limit 500\nCLEANED_AT  CREATED     EXTRA_DATA  FILE  HASH  ID  MALICIOUS  SCAN_ID  SCAN_TYPE  SIZE  STATUS  TYPE  USERNAME\nNone        1599955297  {}          /home/cltest/public_html/test/TsMeJD.php        275a021bbfb6489e54d471899f7db9d1663fc695ec2fe2a2c4538aabf651fd0f  1627  True       1996cd86e6b14b12a1c165e79e3540d9  background  68    found   SMW-SA-05057-eicar.tst-4  cltest   \nNone        1599955297  {}          /home/cltest/public_html/test/TZlfnU.php        275a021bbfb6489e54d471899f7db9d1663fc695ec2fe2a2c4538aabf651fd0f  1628  True       1996cd86e6b14b12a1c165e79e3540d9  background  68    found   SMW-SA-05057-eicar.tst-4  cltest   \nNone        1599955297  {}          /home/cltest/public_html/test/Ke7V8n.php        275a021bbfb6489e54d471899f7db9d1663fc695ec2fe2a2c4538aabf651fd0f  1629  True       1996cd86e6b14b12a1c165e79e3540d9  background  68    found   SMW-SA-05057-eicar.tst-4  cltest   \nNone        1599955297  {}          /home/cltest/public_html/yoUq0L.php             275a021bbfb6489e54d471899f7db9d1663fc695ec2fe2a2c4538aabf651fd0f  1630  True       1996cd86e6b14b12a1c165e79e3540d9  background  68    found   SMW-SA-05057-eicar.tst-4  cltest   \nNone        1599955297  {}          /home/cltest/public_html/test/PKiuhY.php        275a021bbfb6489e54d471899f7db9d1663fc695ec2fe2a2c4538aabf651fd0f  1631  True       1996cd86e6b14b12a1c165e79e3540d9  background  68    found   SMW-SA-05057-eicar.tst-4  cltest   \nNone        1599955297  {}          /home/cltest/public_html/public_html/Zqrsvh.php  275a021bbfb6489e54d471899f7db9d1663fc695\n")])])]),t._v(" "),s("ol",{attrs:{start:"8"}},[s("li",[t._v("The following command adds the specified path to the Ignore List")])]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('imunify-antivirus malware ignore add /home/user1/public_html/ "/home/some user/public_html/index.php"\n')])])])]),t._v(" "),s("ol",{attrs:{start:"9"}},[s("li",[t._v("The following command lists all users and their current infection status")])]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus malware user list\n")])])])]),t._v(" "),s("p",[t._v("The successful initiation/stopping of a scanning process or adding of ignore directories/files should give you "),s("code",[t._v("OK")]),t._v(" in the output.")]),t._v(" "),s("h2",{attrs:{id:"notifications-config"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#notifications-config","aria-hidden":"true"}},[t._v("#")]),t._v(" Notifications config")]),t._v(" "),s("p",[t._v("Allows administrators to execute custom scripts on events execution.")]),t._v(" "),s("p",[s("strong",[t._v("Usage:")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus notifications-config [command] [configuration options]\n")])])]),s("p",[s("span",{staticClass:"notranslate"},[s("code",[t._v("command")])]),t._v(" can be:")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th"),t._v(" "),s("th")])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("show")])])]),t._v(" "),s("td",[t._v("returns the full config as a JSON")])]),t._v(" "),s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("update")])])]),t._v(" "),s("td",[t._v("updates the config (partial update is supported) and returns the full updated config as a JSON")])])])]),t._v(" "),s("p",[t._v("We advise administrators to use the "),s("span",{staticClass:"notranslate"},[s("code",[t._v("notifications-config show")])]),t._v(" to get the full config, pick what they want to edit, and feed it to the "),s("span",{staticClass:"notranslate"},[s("code",[t._v("notifications-config update")])]),t._v(".")]),t._v(" "),s("p",[t._v("The general structure of the "),s("span",{staticClass:"notranslate"},[s("code",[t._v("imunify-antivirus notifications-config show")])]),t._v(" command output:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"rules"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"USER_SCAN_FINISHED"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"SCRIPT"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"enabled"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" False\n         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"USER_SCAN_MALWARE_FOUND"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"SCRIPT"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"enabled"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" False\n         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ADMIN"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"admin_emails"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"enabled"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" False\n         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"USER_SCAN_STARTED"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"SCRIPT"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"enabled"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" False\n         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"CUSTOM_SCAN_STARTED"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"SCRIPT"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"enabled"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" False\n         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"CUSTOM_SCAN_FINISHED"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"SCRIPT"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"enabled"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" False\n         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"CUSTOM_SCAN_MALWARE_FOUND"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"SCRIPT"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"enabled"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" False\n         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ADMIN"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"admin_emails"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"enabled"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" False\n         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"admin"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"notify_from_email"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" None"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"default_emails"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),t._v(" "),s("p",[t._v("Let's review all the options.")]),t._v(" "),s("p",[t._v("Rules:")]),t._v(" "),s("ul",[s("li",[s("span",{staticClass:"notranslate"},[t._v("USER_SCAN_FINISHED")]),t._v(" – occurs immediately after the user scanning has finished, regardless the malware has found or not.")]),t._v(" "),s("li",[s("span",{staticClass:"notranslate"},[t._v("USER_SCAN_MALWARE_FOUND")]),t._v(" – occurs when the malware scanning process of a user account has finished and malware found.")]),t._v(" "),s("li",[s("span",{staticClass:"notranslate"},[t._v("USER_SCAN_STARTED")]),t._v(" – occurs immediately after the user scanning has started.")]),t._v(" "),s("li",[s("span",{staticClass:"notranslate"},[t._v("CUSTOM_SCAN_STARTED")]),t._v(" – occurs immediately after on-demand (manual) scanning has started.")]),t._v(" "),s("li",[s("span",{staticClass:"notranslate"},[t._v("CUSTOM_SCAN_FINISHED")]),t._v(" – occurs immediately after on-demand (manual) scanning has finished, regardless the malware has found or not.")]),t._v(" "),s("li",[s("span",{staticClass:"notranslate"},[t._v("CUSTOM_SCAN_MALWARE_FOUND")]),t._v(" – occurs when the on-demand scanning process has finished and malware found.")])]),t._v(" "),s("p",[t._v("Admin:")]),t._v(" "),s("ul",[s("li",[s("span",{staticClass:"notranslate"},[t._v("default_emails")]),t._v(" – specify the default list of emails used for all enabled admin email notifications.")]),t._v(" "),s("li",[s("span",{staticClass:"notranslate"},[t._v("notify_from_email")]),t._v(" – specify a sender of all emails sent by the Hooks.")])]),t._v(" "),s("p",[s("strong",[t._v("Examples")]),t._v(":")]),t._v(" "),s("ol",[s("li",[t._v("Update admin default emails:")])]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('imunify-antivirus notifications-config update \'{"admin": {"default_emails": ["email1@email.com", "email2@email.com"]}}\'\n')])])])]),t._v(" "),s("p",[t._v("After the successful execution, the "),s("span",{staticClass:"notranslate"},[s("code",[t._v("imunify-antivirus notifications-config update")])]),t._v(" command returns the full config with changes.")]),t._v(" "),s("p",[t._v("The "),s("span",{staticClass:"notranslate"},[s("code",[t._v("imunify-antivirus notifications-config show")])]),t._v(" command output after applying the example 1:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"rules"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"USER_SCAN_FINISHED"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"SCRIPT"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"enabled"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" False\n         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"USER_SCAN_MALWARE_FOUND"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ADMIN"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"admin_emails"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"enabled"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" False\n         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"SCRIPT"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"enabled"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" False\n         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"CUSTOM_SCAN_STARTED"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"SCRIPT"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"enabled"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" False\n         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"USER_SCAN_STARTED"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"SCRIPT"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"enabled"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" False\n         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"CUSTOM_SCAN_FINISHED"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"SCRIPT"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"enabled"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" False\n         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"CUSTOM_SCAN_MALWARE_FOUND"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ADMIN"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"admin_emails"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"enabled"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" False\n         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"SCRIPT"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"enabled"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" False\n         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"admin"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"notify_from_email"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" None"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"default_emails"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"email1@email.com"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"email2@email.com"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),t._v(" "),s("p",[s("strong",[t._v("More examples")]),t._v(":")]),t._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[t._v("Run the custom script on the "),s("span",{staticClass:"notranslate"},[t._v("USER_SCAN_FINISHED")]),t._v(" event occurrence:")])]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('imunify-antivirus notifications-config update \'{"rules": {"USER_SCAN_FINISHED": {"SCRIPT": {"scripts": ["/script/my-handler.py"], "enabled": true}}}}\'\n')])])])]),t._v(" "),s("p",[t._v("After the successful execution, the "),s("span",{staticClass:"notranslate"},[s("code",[t._v("imunify-antivirus notifications-config update")])]),t._v(" command returns the full config with changes.")]),t._v(" "),s("p",[t._v("The "),s("span",{staticClass:"notranslate"},[s("code",[t._v("imunify-antivirus notifications-config show")])]),t._v(" command output after applying the example 2:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"rules"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"CUSTOM_SCAN_MALWARE_FOUND"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"SCRIPT"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"enabled"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" False\n         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ADMIN"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"enabled"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" False"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"admin_emails"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"USER_SCAN_STARTED"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"SCRIPT"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"enabled"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" False\n         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"CUSTOM_SCAN_FINISHED"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"SCRIPT"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"enabled"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" False\n         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"CUSTOM_SCAN_STARTED"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"SCRIPT"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"enabled"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" False\n         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"USER_SCAN_MALWARE_FOUND"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"SCRIPT"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"enabled"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" False\n         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ADMIN"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"enabled"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" False"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"admin_emails"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"USER_SCAN_FINISHED"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n         "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"SCRIPT"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"scripts"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("'/script/my-handler.py'"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"enabled"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" True\n         "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"admin"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"notify_from_email"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" None"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"default_emails"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"email1@email.com"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"email2@email.com"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),t._v(" "),s("h4",{attrs:{id:"example-of-script-to-create-custom-scripts-to-use-with-notifications-config"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#example-of-script-to-create-custom-scripts-to-use-with-notifications-config","aria-hidden":"true"}},[t._v("#")]),t._v(" Example of script to create custom scripts to use with notifications-config")]),t._v(" "),s("p",[t._v("There are two script examples you can download:")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"/hook_script.sh"}},[t._v("Shell script")])]),t._v(" "),s("li",[s("a",{attrs:{href:"/hook_script.py"}},[t._v("Python script")])])]),t._v(" "),s("p",[t._v("You can use these scripts as a reference and customize them.")]),t._v(" "),s("div",{staticClass:"warning custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("Note")]),s("p",[t._v("Set the "),s("code",[t._v("+x")]),t._v(" bits to your script file to make it executable. Your script also has to be readable by the special "),s("span",{staticClass:"notranslate"},[s("code",[t._v("_imunify")])]),t._v(" user, so make sure of setting group's permission accordingly:")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("chown root:_imunify hook_script.sh\n")])])])])]),s("h4",{attrs:{id:"python-script-description"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#python-script-description","aria-hidden":"true"}},[t._v("#")]),t._v(" Python script description")]),t._v(" "),s("p",[t._v("The agent generates messages of different types on hook events. The ‘if chain’ in the script calls the particular method corresponding to type of the event that came from the agent.")]),t._v(" "),s("p",[t._v("To unblock user sites which were scanned as clean, you can use the "),s("code",[t._v("handle_user_scan_finished")]),t._v(" method.")]),t._v(" "),s("p",[t._v("Add your path to the related hook (or multiple hooks) and implement the custom logic of blocking and unblocking sites.")]),t._v(" "),s("p",[t._v("Also in this script you could find the way to parse JSON that come from ImunifyAV(+) and description of this JSON schema in every possible case. Such descriptions are provided by docstring of the "),s("span",{staticClass:"notranslate"},[s("code",[t._v("handle")])]),t._v(" methods.")]),t._v(" "),s("h2",{attrs:{id:"register"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#register","aria-hidden":"true"}},[t._v("#")]),t._v(" Register")]),t._v(" "),s("p",[t._v("Allows to register and activate ImunifyAV. You can use it in case if ImunifyAV was not activated during installation process or in case if activation key of the ImunifyAV was changed for any reason. If you do not know what is an activation key or have any problem with it then, please, read "),s("RouterLink",{attrs:{to:"/imunifyav/#installation-guide"}},[t._v("Installation Guide")]),t._v(" or "),s("a",{attrs:{href:"https://cloudlinux.zendesk.com/hc/requests/new",target:"_blank",rel:"noopener noreferrer"}},[t._v("contact our support team"),s("OutboundLink")],1),t._v(".")],1),t._v(" "),s("p",[s("strong",[t._v("Usage:")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus register [--optional arguments] [KEY]\n")])])]),s("p",[s("code",[t._v("KEY")]),t._v(" is a positional argument:")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th"),t._v(" "),s("th")])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("code",[t._v("KEY")])]),t._v(" "),s("td",[t._v("register with activation key (use "),s("code",[t._v("IPL")]),t._v(" to register by IP)")])])])]),t._v(" "),s("p",[t._v("If you will use this command without the "),s("code",[t._v("KEY")]),t._v(" argument, then it will try to register and activate current activation key.")]),t._v(" "),s("p",[s("strong",[t._v("Example 1:")]),t._v("\nThe following command will register and activate Imunify360 with the provided activation key:")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus register IMAV250jjRRjowbjk56dGN\nOK\n")])])]),s("p",[s("strong",[t._v("Example 2:")]),t._v("\nIf you have an IP-based license, you can use "),s("code",[t._v("IPL")]),t._v(" argument to register and activate ImunifyAV:")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus register IPL\nOK\n")])])]),s("h2",{attrs:{id:"rstatus"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#rstatus","aria-hidden":"true"}},[t._v("#")]),t._v(" Rstatus")]),t._v(" "),s("p",[t._v("Allows to check if ImunifyAV server license is valid.")]),t._v(" "),s("p",[s("strong",[t._v("Usage:")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus rstatus [--optional arguments]\n")])])]),s("p",[t._v("An extended variation (otherwise, you receive "),s("code",[t._v("OK")]),t._v(" if everything is fine with the license registered):")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('imunify-antivirus rstatus --json -v\n{\n  "expiration": null,\n  "id": "SSXX11xXXXxxxxXX",\n  "ip_license": false,\n  "license": {\n    "expiration": null,\n    "id": "SSXX11xXXXxxxxXX",\n    "ip_license": false,\n    "license_type": "imunify-antivirus",\n    "message": " ",\n    "status": true,\n    "upgrade_url": "  ",\n    "user_count": 100,\n    "user_limit": 2147483647\n  },\n  "license_type": "imunify-antivirus",\n  "message": " ",\n  "status": true,\n  "upgrade_url": " ",\n  "user_count": 100,\n  "user_limit": 2147483647,\n  "version": "5.1.2-1"\n}\n')])])]),s("h2",{attrs:{id:"submit-false-positive-false-negative"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#submit-false-positive-false-negative","aria-hidden":"true"}},[t._v("#")]),t._v(" Submit false-positive/false-negative")]),t._v(" "),s("p",[t._v("To submit file as false positive for analysis (if ImunifyAV considers file as a malicious but it actually isn't), you can use the following command (please make sure to specify the file name along with full path):")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus submit false-positive <file>\n")])])])]),t._v(" "),s("p",[t._v("To submit file as false negative for analysis (if ImunifyAV considers file as a non-malicious but it actually does), you can use the following command (please make sure to specify the file name along with full path):")]),t._v(" "),s("div",{staticClass:"notranslate"},[s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus submit false-negative <file>\n")])])])]),t._v(" "),s("p",[t._v("Optional arguments:")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th"),t._v(" "),s("th")])]),t._v(" "),s("tbody",[s("tr",[s("td",[s("span",{staticClass:"notranslate"},[s("code",[t._v("-h")]),t._v(", "),s("code",[t._v("--help")])])]),t._v(" "),s("td",[t._v("show this help message and exit")])])])]),t._v(" "),s("h2",{attrs:{id:"unregister"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#unregister","aria-hidden":"true"}},[t._v("#")]),t._v(" Unregister")]),t._v(" "),s("p",[t._v("Allows to unregister and disable ImunifyAV on the server.")]),t._v(" "),s("p",[s("strong",[t._v("Usage:")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus unregister [--optional arguments]\nOK\n")])])]),s("h2",{attrs:{id:"update"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#update","aria-hidden":"true"}},[t._v("#")]),t._v(" Update")]),t._v(" "),s("p",[t._v("This command allows updating ImunifyAV malware signatures.")]),t._v(" "),s("p",[s("strong",[t._v("Usage:")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus update sign\nOK\n")])])]),s("h2",{attrs:{id:"update-license"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#update-license","aria-hidden":"true"}},[t._v("#")]),t._v(" Update-license")]),t._v(" "),s("p",[t._v("This command force updating the ImunifyAV license.")]),t._v(" "),s("p",[s("strong",[t._v("Usage:")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus update-license [--optional arguments]\nOK\n")])])]),s("h2",{attrs:{id:"version"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#version","aria-hidden":"true"}},[t._v("#")]),t._v(" Version")]),t._v(" "),s("p",[t._v("Allows to show the actual ImunifyAV version installed on the server.")]),t._v(" "),s("p",[s("strong",[t._v("Usage:")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("imunify-antivirus version [--optional arguments]\n5.1.2-1\n")])])]),s("h2",{attrs:{id:"how-to-apply-changes-from-cli"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#how-to-apply-changes-from-cli","aria-hidden":"true"}},[t._v("#")]),t._v(" How to apply changes from CLI")]),t._v(" "),s("p",[t._v("In order to apply changes via command-line interface (CLI), you can use the following command:")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('imunify-antivirus config update \'{"SECTION": {"parameter": value}}\'\n')])])]),s("p",[t._v("For example, if you want to set "),s("code",[t._v("MALWARE_SCAN_INTENSITY.cpu = 5")]),t._v(" from a command line, then you should execute the following command:")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('imunify-antivirus config update \'{"MALWARE_SCAN_INTENSITY": {"cpu": 5}}\'\nimunify-antivirus config update \'{"MALWARE_SCANNING": {"rapid_scan": true}}\'\n')])])]),s("p",[t._v("It is also possible to apply several parameters at once.")]),t._v(" "),s("p",[t._v("For example:")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('imunify-antivirus config update \'{"MALWARE_SCAN_INTENSITY": {"cpu": 5, "io": 7}}\'\n')])])])])},[],!1,null,null,null);a.default=n.exports}}]);