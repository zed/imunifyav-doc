<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ImunifyAV for cPanel and DirectAdmin | Documentation</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="::: tip Note
This ImunifyAV documentation is applicable for cPanel and DirectAdmin control panels only.
:::">
    <meta name="image" content="https://docs.imunifyav.com/images/AVUsersList.png">
    <meta name="twitter:title" content="ImunifyAV for cPanel and DirectAdmin">
    <meta name="twitter:description" content="::: tip Note
This ImunifyAV documentation is applicable for cPanel and DirectAdmin control panels only.
:::">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://docs.imunifyav.com/images/AVUsersList.png">
    <meta name="twitter:url" content="https://docs.imunifyav.com/imunifyav/">
    <meta property="og:type" content="article">
    <meta property="og:title" content="ImunifyAV for cPanel and DirectAdmin">
    <meta property="og:description" content="::: tip Note
This ImunifyAV documentation is applicable for cPanel and DirectAdmin control panels only.
:::">
    <meta property="og:image" content="https://docs.imunifyav.com/images/AVUsersList.png">
    <meta property="og:url" content="https://docs.imunifyav.com/imunifyav/">
    <meta property="og:site_name" content="ImunifyAV Documentation">
    <meta itemprop="name" content="ImunifyAV for cPanel and DirectAdmin">
    <meta itemprop="description" content="::: tip Note
This ImunifyAV documentation is applicable for cPanel and DirectAdmin control panels only.
:::">
    <meta itemprop="image" content="https://docs.imunifyav.com/images/AVUsersList.png">
    <link rel="preload" href="/assets/css/0.styles.ca1e70c3.css" as="style"><link rel="preload" href="/assets/js/app.6629b37e.js" as="script"><link rel="preload" href="/assets/js/4.5c949845.js" as="script"><link rel="preload" href="/assets/js/1.617ab414.js" as="script"><link rel="preload" href="/assets/js/26.6a906275.js" as="script"><link rel="preload" href="/assets/js/19.aba410b3.js" as="script"><link rel="prefetch" href="/assets/js/10.74505444.js"><link rel="prefetch" href="/assets/js/11.48ee898b.js"><link rel="prefetch" href="/assets/js/12.52a69694.js"><link rel="prefetch" href="/assets/js/13.922873af.js"><link rel="prefetch" href="/assets/js/14.9fcd113f.js"><link rel="prefetch" href="/assets/js/15.c2c5fa34.js"><link rel="prefetch" href="/assets/js/16.785ad469.js"><link rel="prefetch" href="/assets/js/17.1a909581.js"><link rel="prefetch" href="/assets/js/18.97619647.js"><link rel="prefetch" href="/assets/js/20.07433b48.js"><link rel="prefetch" href="/assets/js/21.2c93ea93.js"><link rel="prefetch" href="/assets/js/22.3a5d533d.js"><link rel="prefetch" href="/assets/js/23.be495563.js"><link rel="prefetch" href="/assets/js/24.6d9d09d3.js"><link rel="prefetch" href="/assets/js/25.9dc0ae1e.js"><link rel="prefetch" href="/assets/js/27.f0c3ec72.js"><link rel="prefetch" href="/assets/js/28.ec9e8777.js"><link rel="prefetch" href="/assets/js/29.ea3dfcb2.js"><link rel="prefetch" href="/assets/js/30.70d0546b.js"><link rel="prefetch" href="/assets/js/5.986b7abe.js"><link rel="prefetch" href="/assets/js/6.6a8339de.js"><link rel="prefetch" href="/assets/js/7.f392399e.js"><link rel="prefetch" href="/assets/js/8.8631a238.js"><link rel="prefetch" href="/assets/js/9.1f7dd040.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.38015cce.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ca1e70c3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/imunifyav/" class="home-link router-link-exact-active router-link-active"><img src="/logo.svg" alt="Documentation" class="logo"> <span class="site-name site-name--documentation can-hide">Documentation</span></a> <form id="search-form" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <div class="links" style="max-width:nullpx;"><a href="https://cloudlinux.zendesk.com/hc/en-us/requests/new" target="_blank" class="btn">
      Submit Request
    </a> <a href="https://www.imunify360.com/antivirus" target="_blank" class="btn">
      Get Free
    </a> <nav class="nav-links can-hide"></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><div class="sidebar-heading open"><span>Contents</span> <!----></div> <ul class="sidebar-group-items"><li><div class="active collapsed sidebar-header sidebar-link"><div class="active"><a href="/imunifyav/" class="active sidebar-link">ImunifyAV for cPanel and DirectAdmin</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/imunifyav/#installation-guide" class="sidebar-link">Installation Guide</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/imunifyav/#requirements" class="sidebar-link">Requirements</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav/#installation-instructions" class="sidebar-link">Installation Instructions</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav/#update-instructions" class="sidebar-link">Update Instructions</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav/#gradual-roll-out" class="sidebar-link">Gradual roll-out</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/imunifyav/#uninstall" class="sidebar-link">Uninstall</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/imunifyav/#how-to-uninstall-imunifyav" class="sidebar-link">How to uninstall ImunifyAV</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav/#how-to-stop-imunifyav" class="sidebar-link">How to stop ImunifyAV</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/imunifyav/#localization" class="sidebar-link">Localization</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/imunifyav/#how-to-perform-a-translation-to-your-own-language-using-our-language-file" class="sidebar-link">How to perform a translation to your own language using our language file</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/imunifyav/#hoster-interface" class="sidebar-link">Hoster Interface</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/imunifyav/#users" class="sidebar-link">Users</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav/#files" class="sidebar-link">Files</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav/#scan" class="sidebar-link">Scan</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav/#history" class="sidebar-link">History</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav/#ignore-list" class="sidebar-link">Ignore List</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav/#features-management" class="sidebar-link">Features Management</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav/#reputation-management" class="sidebar-link">Reputation Management</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav/#settings" class="sidebar-link">Settings</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav/#upgrade" class="sidebar-link">Upgrade</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/imunifyav/#end-user-interface" class="sidebar-link">End User Interface</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/imunifyav/#files-2" class="sidebar-link">Files</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav/#history-2" class="sidebar-link">History</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav/#ignore-list-2" class="sidebar-link">Ignore List</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/imunifyav/#hooks" class="sidebar-link">Hooks</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/imunifyav/#overview" class="sidebar-link">Overview</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav/#how-to-start-using-hooks" class="sidebar-link">How to start using hooks</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav/#available-events-and-their-parameters" class="sidebar-link">Available events and their parameters</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav/#hooks-cli" class="sidebar-link">Hooks CLI</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav/#structure-and-examples-of-a-hook-script" class="sidebar-link">Structure and examples of a hook script</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav/#notifications" class="sidebar-link">Notifications</a></div></li></ul></li></ul></li><li><div class="sidebar-header sidebar-link"><div><a href="/cli/" class="sidebar-link">Command-Line Interface</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/cli/#add-sudouser" class="sidebar-link">Add-sudouser</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/cli/#checkdb" class="sidebar-link">Checkdb</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/cli/#check-domains" class="sidebar-link">Check-domains</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/cli/#config-update" class="sidebar-link">Config update</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/cli/#delete-sudouser" class="sidebar-link">Delete-sudouser</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/cli/#doctor" class="sidebar-link">Doctor</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/cli/#infected-domains" class="sidebar-link">Infected-domains</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/cli/#feature-management" class="sidebar-link">Feature-management</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/cli/#hooks" class="sidebar-link">Hooks</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/cli/#login" class="sidebar-link">Login</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/cli/#malware" class="sidebar-link">Malware</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/cli/#notifications-config" class="sidebar-link">Notifications config</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/cli/#register" class="sidebar-link">Register</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/cli/#rstatus" class="sidebar-link">Rstatus</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/cli/#submit-false-positive-false-negative" class="sidebar-link">Submit false-positive/false-negative</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/cli/#unregister" class="sidebar-link">Unregister</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/cli/#update" class="sidebar-link">Update</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/cli/#update-license" class="sidebar-link">Update-license</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/cli/#version" class="sidebar-link">Version</a></div></li><li class="collapsible sidebar-sub-header"><div><a href="/cli/#how-to-apply-changes-from-cli" class="sidebar-link">How to apply changes from CLI</a></div></li></ul></li><li><div class="sidebar-header sidebar-link sidebar-header--empty"><div><a href="/config_file_description/" class="sidebar-link">Config File Description</a></div></div><ul class="sidebar-sub-headers"></ul></li><li><div class="sidebar-header sidebar-link"><div><a href="/stand_alone_mode/" class="sidebar-link">Stand-alone version of ImunifyAV+ (non-panel, generic panel integration)</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div><a href="/stand_alone_mode/#integration-config-file" class="sidebar-link">Integration config file</a></div></li></ul></li><li><div class="sidebar-header sidebar-link"><div><a href="/imunifyav_for_plesk/" class="sidebar-link">ImunifyAV(+) for Plesk</a></div></div><ul class="sidebar-sub-headers"><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/imunifyav_for_plesk/#general-overview" class="sidebar-link">General overview</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/imunifyav_for_plesk/#key-features" class="sidebar-link">Key features</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav_for_plesk/#editions-available" class="sidebar-link">Editions available</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav_for_plesk/#comparison-table" class="sidebar-link">Comparison table</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/imunifyav_for_plesk/#quick-introduction-for-server-admins" class="sidebar-link">Quick introduction for server admins</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/imunifyav_for_plesk/#premium-imunifyav-version-and-automatic-malware-cleanup" class="sidebar-link">Premium (ImunifyAV+) version and automatic malware cleanup</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav_for_plesk/#video" class="sidebar-link">Video</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div><a href="/imunifyav_for_plesk/#quick-introduction-for-users" class="sidebar-link">Quick introduction for users</a></div></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/imunifyav_for_plesk/#explanations" class="sidebar-link">Explanations</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/imunifyav_for_plesk/#explaining-the-domain-tab" class="sidebar-link">Explaining the Domain tab</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav_for_plesk/#explaining-the-settings-tab" class="sidebar-link">Explaining the Settings tab</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav_for_plesk/#how-to-activate-a-license-key-for-paid-versions" class="sidebar-link">How to activate a license key (for paid versions)</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav_for_plesk/#how-the-antivirus-removes-malware" class="sidebar-link">How the Antivirus removes malware</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/imunifyav_for_plesk/#faq" class="sidebar-link">FAQ</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/imunifyav_for_plesk/#does-imunifyav-protect-websites" class="sidebar-link">Does ImunifyAV protect websites?</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav_for_plesk/#my-websites-are-clean-what-to-do-next" class="sidebar-link">My websites are clean, what to do next?</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav_for_plesk/#my-websites-are-infected-what-to-do-next" class="sidebar-link">My websites are infected, what to do next?</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav_for_plesk/#what-to-do-when-antivirus-has-detected-malware-in-the-legitimate-file" class="sidebar-link">What to do when antivirus has detected malware in the legitimate file?</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav_for_plesk/#how-to-speed-up-the-antivirus" class="sidebar-link">How to speed up the Antivirus?</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav_for_plesk/#how-to-update-the-antivirus" class="sidebar-link">How to update the Antivirus?</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav_for_plesk/#what-if-the-antivirus-has-not-detected-some-malicious-files" class="sidebar-link">What if the Antivirus has not detected some malicious files?</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav_for_plesk/#where-can-i-find-the-imunifyav-log-file-on-plesk" class="sidebar-link">Where can I find the ImunifyAV log file on Plesk?</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav_for_plesk/#dashboard-says-scan-failed-with-no-related-error-message" class="sidebar-link">Dashboard says &quot;scan failed&quot; with no related error message</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/imunifyav_for_plesk/#troubleshooting" class="sidebar-link">Troubleshooting</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/imunifyav_for_plesk/#i-payed-for-the-extension-but-it-is-not-yet-premium" class="sidebar-link">I payed for the extension, but it is not yet Premium</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav_for_plesk/#i-click-the-scan-button-but-it-doesn-t-start-scanning" class="sidebar-link">I click the Scan button, but it doesn’t start scanning</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav_for_plesk/#the-antivirus-doesn-t-cleanup-some-of-malicious-files" class="sidebar-link">The Antivirus doesn’t cleanup some of malicious files</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav_for_plesk/#i-scheduled-re-scanning-for-today-but-it-does-not-start-at-specified-time" class="sidebar-link">I scheduled re-scanning for today but it does not start at specified time</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav_for_plesk/#when-i-click-the-scan-all-button-the-websites-start-scanning-in-random-order" class="sidebar-link">When I click the Scan All button the websites start scanning in random order</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav_for_plesk/#when-i-click-scan-or-clean-it-fails" class="sidebar-link">When I click Scan or Clean it fails</a></div></li><li class="sidebar-sub-header"><div><a href="/imunifyav_for_plesk/#problem-with-websites-cleanup" class="sidebar-link">Problem with websites cleanup</a></div></li></ul></li><li class="collapsible sidebar-sub-header"><div><a href="/imunifyav_for_plesk/#removing-imunifyav-for-plesk" class="sidebar-link">Removing ImunifyAV for Plesk</a></div></li><li class="collapsible sidebar-sub-header"><div class="sidebar-link-container"><a href="/imunifyav_for_plesk/#extension-diagnostics" class="sidebar-link">Extension diagnostics</a></div><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><div><a href="/imunifyav_for_plesk/#how-to-collect-plesk-debug-log" class="sidebar-link">How to collect Plesk debug log</a></div></li></ul></li></ul></li><li><div><a href="/imunifyav_for_ispmanager/" class="sidebar-link">ImunifyAV/ImunifyAV+ for ISPmanager</a></div></li><li><div class="sidebar-header sidebar-link sidebar-header--empty"><div><a href="/faq_and_known_issues/" class="sidebar-link">FAQ and Known Issues</a></div></div><ul class="sidebar-sub-headers"></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="breadcrumb-wrapper page-breadcrumb" data-v-5e0e0acf><span class="breadcrumb-title" data-v-5e0e0acf>Documentation:</span> <a href="/imunifyav/" class="breadcrumb router-link-exact-active router-link-active" data-v-5e0e0acf>
    ImunifyAV for cPanel and DirectAdmin
  </a></div> <div class="page-nav-wrapper"><div class="page-nav"><!----> <a href="/cli/" class="nav-arrow right"></a></div></div> <div class="content content__default"><h1 id="imunifyav-for-cpanel-and-directadmin"><a href="#imunifyav-for-cpanel-and-directadmin" aria-hidden="true" class="header-anchor">#</a> ImunifyAV for cPanel and DirectAdmin</h1> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>This ImunifyAV documentation is applicable for <strong>cPanel</strong> and <strong>DirectAdmin</strong> control panels only.</p></div><ul><li>You can find documentation for ImunifyAV for <strong>Plesk</strong> <a href="/imunifyav_for_plesk/">here</a></li> <li>You can find documentation for ImunifyAV for <strong>ISPmanager</strong> <a href="https://docs.ispsystem.com/ispmanager-lite/integrations/integration-with-imunifyav" target="_blank" rel="noopener noreferrer">here<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>You can find documentation for <strong>stand-alone (no-panel)</strong> version of ImunifyAV <a href="/stand_alone_mode/">here</a></li></ul> <p>ImunifyAV provides malware scanning features for cPanel and DirectAdmin control panels.</p> <ul><li><a href="/imunifyav/#installation-guide">Installation Guide</a> <ul><li><a href="/imunifyav/#requirements">Requirements</a></li> <li><a href="/imunifyav/#installation-instructions">Installation Instructions</a></li> <li><a href="/imunifyav/#update-instructions">Update Instructions</a></li> <li><a href="/imunifyav/#gradual-roll-out">Gradual roll-out</a></li></ul></li> <li><a href="/imunifyav/#uninstall">Uninstall</a> <ul><li><a href="/imunifyav/#how-to-uninstall-imunifyav">How to uninstall ImunifyAV</a></li> <li><a href="/imunifyav/#how-to-stop-imunifyav">How to stop ImunifyAV</a></li></ul></li> <li><a href="/imunifyav/#localization">Localization</a> <ul><li><a href="/imunifyav/#how-to-perform-a-translation-to-your-own-language-using-our-language-file">How to perform a translation to your own language using our language file</a></li></ul></li> <li><a href="/imunifyav/#hoster-interface">Hoster Interface</a> <ul><li><a href="/imunifyav/#users">Users</a></li> <li><a href="/imunifyav/#files">Files</a></li> <li><a href="/imunifyav/#scan">Scan</a></li> <li><a href="/imunifyav/#history">History</a></li> <li><a href="/imunifyav/#ignore-list">Ignore List</a></li> <li><a href="/imunifyav/#features-management">Features Management (AV+)</a></li> <li><a href="/imunifyav/#reputation-management">Reputation Management (AV+)</a></li> <li><a href="/imunifyav/#settings">Settings</a></li> <li><a href="/imunifyav/#upgrade">Upgrade (AV)</a></li></ul></li> <li><a href="/imunifyav/#end-user-interface">End User Interface</a> <ul><li><a href="/imunifyav/#files-2">Files</a></li> <li><a href="/imunifyav/#history-2">History</a></li> <li><a href="/imunifyav/#ignore-list-2">Ignore List</a></li></ul></li> <li><a href="/imunifyav/#hooks">Hooks</a> <ul><li><a href="/imunifyav/#overview">Overview</a></li> <li><a href="/imunifyav/#how-to-start-using-hooks">How to start using hooks</a></li> <li><a href="/imunifyav/#available-events-and-their-parameters">Available events and their parameters</a></li> <li><a href="/imunifyav/#hooks-cli">Hooks CLI</a></li> <li><a href="/imunifyav/#structure-and-examples-of-a-hook-script">Structure and examples of a hook script</a></li> <li><a href="/imunifyav/#notifications">Notifications</a></li></ul></li></ul> <h2 id="installation-guide"><a href="#installation-guide" aria-hidden="true" class="header-anchor">#</a> Installation Guide</h2> <h3 id="requirements"><a href="#requirements" aria-hidden="true" class="header-anchor">#</a> Requirements</h3> <p><strong>Operating systems</strong></p> <ul><li>CentOS/RHEL 6,7,8</li> <li>CloudLinux OS 6,7,8</li> <li>Ubuntu 16.04 (LTS only), 18.04 and 20.04</li> <li>Debian 9 and 10</li></ul> <p><strong>Virtualization</strong></p> <ul><li>OpenVZ - Works for Virtuozzo 7</li></ul> <p><strong>Hardware</strong></p> <ul><li>RAM: 512 Mb</li> <li>HDD: 20 Gb available disk space</li></ul> <p><strong>Supported hosting panels</strong></p> <ul><li>cPanel</li> <li>DirectAdmin</li> <li><a href="/stand_alone_mode/">No hosting panel systems</a></li></ul> <p><strong>Required browsers</strong></p> <ul><li>Safari version 9.1 or later</li> <li>Chrome version 39 or later</li> <li>Firefox version 28 or later</li> <li>Edge version 17 or later</li> <li>Internet Explorer version 11 or later</li></ul> <h3 id="installation-instructions"><a href="#installation-instructions" aria-hidden="true" class="header-anchor">#</a> Installation Instructions</h3> <div class="warning custom-block"><p class="custom-block-title">Warning</p><p>On DirectAdmin, Imunify UI requires the <code>proc_open</code> PHP function to be enabled. If you are unable to open the Imunify UI, you might see a related message in the <code>errror.log</code> of the web-server. If so, please remove it from the <code>disable_functions</code> list in <code>php.ini</code>.</p></div><p>To install ImunifyAV proceed the following steps:</p> <ol><li><p>Log in with root privileges to the server where ImunifyAV should be installed.</p></li> <li><p>Go to your home directory and run the commands:</p></li></ol> <div class="language- extra-class"><pre class="language-text"><code>wget https://repo.imunify360.cloudlinux.com/defence360/imav-deploy.sh
bash imav-deploy.sh
</code></pre></div><p>To install ImunifyAV beta version add argument <code>--beta</code>. For example:</p> <div class="language- extra-class"><pre class="language-text"><code>bash imav-deploy.sh --beta
</code></pre></div><p>If you already have <strong>ImunifyAV+</strong> license key you can use it during installation:</p> <div class="language- extra-class"><pre class="language-text"><code>wget https://repo.imunify360.cloudlinux.com/defence360/imav-deploy.sh
bash imav-deploy.sh --key YOUR_KEY
</code></pre></div><p>where <code>YOUR_KEY</code> is your license key. Replace <code>YOUR_KEY</code> with the actual key purchased at <a href="https://www.imunify360.com/" target="_blank" rel="noopener noreferrer">https://www.imunify360.com/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>If you have an IP-based license for <strong>ImunifyAV+</strong>, use IPL as license key:</p> <div class="language- extra-class"><pre class="language-text"><code>wget https://repo.imunify360.cloudlinux.com/defence360/imav-deploy.sh
bash imav-deploy.sh --key IPL
</code></pre></div><p>To view available options for installation script run:</p> <div class="language- extra-class"><pre class="language-text"><code>bash imav-deploy.sh -h
</code></pre></div><p>In a case of registration key is passed later, then you can register an activation key via the <code>imunify-antivirus</code> command:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify-antivirus register YOUR_KEY
</code></pre></div><p>Where <code>YOUR_KEY</code> is your activation key or IPL in case of IP-based license.</p> <h3 id="update-instructions"><a href="#update-instructions" aria-hidden="true" class="header-anchor">#</a> Update Instructions</h3> <p>To upgrade ImunifyAV run the command:</p> <div class="language- extra-class"><pre class="language-text"><code>yum update imunify-antivirus
</code></pre></div><p>To update ImunifyAV beta version run the command:</p> <div class="language- extra-class"><pre class="language-text"><code>yum update imunify-antivirus --enablerepo=imunify360-testing
</code></pre></div><p>To update ImunifyAV on Ubuntu/Debian run the command:</p> <div class="language- extra-class"><pre class="language-text"><code>apt-get update
apt-get install --only-upgrade imunify-antivirus
</code></pre></div><p>To update ImunifyAV <strong>beta</strong> on Ubuntu 16.04 LTS run the command:</p> <div class="language- extra-class"><pre class="language-text"><code>echo 'deb https://repo.imunify360.cloudlinux.com/imunify360/ubuntu-testing/16.04/ xenial main'  &gt; /etc/apt/sources.list.d/imunify360-testing.list
apt-get update
apt-get install --only-upgrade imunify-antivirus
</code></pre></div><p>To update ImunifyAV <strong>beta</strong> on Ubuntu 18.04 run the command:</p> <div class="language- extra-class"><pre class="language-text"><code>echo 'deb https://repo.imunify360.cloudlinux.com/imunify360/ubuntu-testing/18.04/ bionic main'  &gt; /etc/apt/sources.list.d/imunify360-testing.list
apt-get update
apt-get install --only-upgrade imunify-antivirus
</code></pre></div><p>To update ImunifyAV <strong>beta</strong> on Debian run the command:</p> <div class="language- extra-class"><pre class="language-text"><code>echo 'deb https://repo.imunify360.cloudlinux.com/imunify360/debian-testing/10/ buster main'  &gt; /etc/apt/sources.list.d/imunify360-testing.list
apt-get update
apt-get install --only-upgrade imunify-antivirus
</code></pre></div><p>If you do not want to receive updates from beta, remove beta repository:</p> <div class="language- extra-class"><pre class="language-text"><code>rm /etc/apt/sources.list.d/imunify360-testing.list
apt-get update
</code></pre></div><h3 id="gradual-roll-out"><a href="#gradual-roll-out" aria-hidden="true" class="header-anchor">#</a> Gradual roll-out</h3> <p>New stable ImunifyAV versions are scheduled for the gradual roll-out from our production repository and are available for all customers in about two weeks or less from the release.</p> <p>If you do not want to wait for the gradual roll-out, you can update ImunifyAV to the latest version by running the following commands:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>wget https://repo.imunify360.cloudlinux.com/defence360/imunify-force-update.sh
bash imunify-force-update.sh
</code></pre></div></div> <h2 id="uninstall"><a href="#uninstall" aria-hidden="true" class="header-anchor">#</a> Uninstall</h2> <h3 id="how-to-uninstall-imunifyav"><a href="#how-to-uninstall-imunifyav" aria-hidden="true" class="header-anchor">#</a> How to uninstall ImunifyAV</h3> <p>To uninstall ImunifyAV, run the command:</p> <div class="language- extra-class"><pre class="language-text"><code>bash imav-deploy.sh --uninstall
</code></pre></div><p>If you have already removed <code>imav-deploy.sh</code> then download it by running:</p> <div class="language- extra-class"><pre class="language-text"><code>wget https://repo.imunify360.cloudlinux.com/defence360/imav-deploy.sh
</code></pre></div><p>And proceed to the directory with the script.</p> <h3 id="how-to-stop-imunifyav"><a href="#how-to-stop-imunifyav" aria-hidden="true" class="header-anchor">#</a> How to stop ImunifyAV</h3> <p>For CentOS/CloudLinux OS 6, run the following command:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>service imunify-antivirus stop
</code></pre></div></div> <p>For all other operating systems, run the following command:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>systemctl stop imunify-antivirus
</code></pre></div></div> <h2 id="localization"><a href="#localization" aria-hidden="true" class="header-anchor">#</a> Localization</h2> <p>ImunifyAV supports the following languages in addition to default (en-US):</p> <ul><li>de-DE</li> <li>es-ES</li> <li>fr-FR</li> <li>ja-JP</li> <li>it-IT</li> <li>tr-TR</li> <li>nl-NL</li> <li>ru-RU</li> <li>pt-BR</li> <li>zh-CN</li></ul> <h3 id="how-to-perform-a-translation-to-your-own-language-using-our-language-file"><a href="#how-to-perform-a-translation-to-your-own-language-using-our-language-file" aria-hidden="true" class="header-anchor">#</a> How to perform a translation to your own language using our language file</h3> <ul><li><p>Contact ImunifyAV support to request the latest language file.</p></li> <li><p>The file is actually in JSON format, which values are the translation.</p></li> <li><p>We use this syntax to translate plurals and other dynamic content:
<a href="https://messageformat.github.io/messageformat/page-guide" target="_blank" rel="noopener noreferrer">https://messageformat.github.io/messageformat/page-guide<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>Note, that you can use it to provide translation for each plural case in your language:
<a href="http://www.unicode.org/cldr/charts/latest/supplemental/language_plural_rules.html" target="_blank" rel="noopener noreferrer">http://www.unicode.org/cldr/charts/latest/supplemental/language_plural_rules.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li> <li><p>You can use this tool to simplify the process: <a href="https://translation-manager-86c3d.firebaseapp.com/" target="_blank" rel="noopener noreferrer">https://translation-manager-86c3d.firebaseapp.com/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li> <li><p>Send the translated version to us and we will gladly include it in one of the nearest releases of ImunifyAV.</p></li></ul> <h2 id="hoster-interface"><a href="#hoster-interface" aria-hidden="true" class="header-anchor">#</a> Hoster Interface</h2> <p>Click <em>ImunifyAV</em> in the main menu. There are following tabs in ImunifyAV hoster interface:</p> <ul><li><a href="/imunifyav/#users">Users</a></li> <li><a href="/imunifyav/#files">Files</a></li> <li><a href="/imunifyav/#scan">Scan</a></li> <li><a href="/imunifyav/#history">History</a></li> <li><a href="/imunifyav/#ignore-list">Ignore List</a></li> <li><a href="/imunifyav/#features-management">Features Management</a></li> <li><a href="/imunifyav/#settings">Settings</a></li> <li><a href="/imunifyav/#upgrade">Upgrade</a></li></ul> <h3 id="users"><a href="#users" aria-hidden="true" class="header-anchor">#</a> Users</h3> <p>Go to ImunifyAV → Users tab. Here, there is a table with a list of users on the server, except users with root privileges.</p> <table><thead><tr><th style="text-align:center;"><img src="/images/AVUsersList.png" alt="ImunifyAV → Users tab"></th></tr></thead> <tbody></tbody></table> <p>The table has the following columns:</p> <ul><li><strong>User name</strong> — displays a user name.</li> <li><strong>Home directory</strong> — a path to a user home directory starting from the root.</li> <li><strong>Infection status</strong> — a current status depending on the last action made:
<ul><li><strong>On-Demand scanning</strong> — scanning is in progress.</li> <li><strong>Cleaning up</strong> — user's files are now cleaning up.</li> <li><strong>Number of threats</strong> — a number of infected files detected after scanning. Click to go to the <em>Files</em> tab where you can see all malicious files.</li> <li><strong>No malware found</strong> — no malware was found during scanning.</li> <li><strong>Malware cleaned</strong> – click a link to go to the <em>History</em> tab and see details.</li></ul></li> <li><strong>Actions</strong>:
<ul><li><strong>Scan for malware</strong> — click <em>Scan</em> icon to start scanning files for a particular user.</li> <li><strong>View report</strong> — click <em>View Report</em> icon to go to the <em>Files</em> tab and display the results of the last scan.</li> <li><strong>Cleanup<sup>AV+</sup></strong> — click <em>Cleanup</em> to start cleaning up infected files for a user.</li> <li><strong>Restore original<sup>AV+</sup></strong> — click <em>Restore original</em> to restore the original file after cleaning up if a backup is available. To perform a bulk action, tick required users and click the corresponding button above the table.</li></ul></li></ul> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>Cleaning up all files of all users and scanning all files is available in ImunifyAV+. To upgrade to ImunifyAV+, click <strong>Upgrade to ImunifyAV+</strong> , you will be redirected to the <a href="/imunifyav/#upgrade">ImunifyAV+ upgrade</a> page. Or click <em>Cleanup all</em> button, you will be redirected to the <a href="/imunifyav/#upgrade">ImunifyAV+ upgrade</a> page.</p></div><p>The badge in the <em>History</em> tab shows the number of missed events in the Malware Scanner’s History.</p> <p>The following filters are available:</p> <p><strong>Items per page displayed</strong> — click the number at the table bottom.</p> <p>The table can be sorted by <em>User name</em> and <em>Infection status</em> (by the date of the last action).</p> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>Starting from ImunifyAV(+) v. 5.5, all filter and view options are stored in the browser's local storage so you can select filter preference options once and next time you'll open the tab, the options will be preset.</p></div><h3 id="files"><a href="#files" aria-hidden="true" class="header-anchor">#</a> Files</h3> <p>Go to ImunifyAV → Files tab. Here, there is a table with a list of infected files within all domains and user accounts.</p> <table><thead><tr><th style="text-align:center;"><img src="/images/AVFilesTab.png" alt="ImunifyAV → Files tab"></th></tr></thead> <tbody></tbody></table> <p>The table has the following columns:</p> <ul><li><strong>Scan date</strong> — displays the exact time the scanning process has started.</li> <li><strong>Username</strong> — displays a file owner name.</li> <li><strong>File</strong> — a path where a file is located starting with root</li> <li><strong>Reason</strong> — describes the signature which was detected during the scanning process. Names in this column depend on the signature vendor. You can derive some information from the signature ID itself. <code>SMW-SA-05155-wshll</code> – in this Signature ID:
<ul><li>The first section can be either <code>SMW</code> or <code>CMW</code>. <code>SMW</code> stands for Server Malware and <code>CMW</code> stands for Client Malware</li> <li>The second section of ID can be either <code>INJ</code> or <code>SA</code>. <code>INJ</code> stands for Injection (means Malware is Injected to some legitimate file) and <code>SA</code> stands for StandAlone (means File is Completely Malicious)</li> <li>The third section is <code>05155</code>. This is simply an identification number for the signature.</li> <li>The fourth section <code>wshll/mlw.wp/etc</code> explains the category and class of malware identified. Here, <code>wshll</code> stands for web shell (<code>mlw</code> stands for malware).</li> <li>The fifth section is <code>0</code>, which provides the version number of the signature.</li></ul></li> <li><strong>Status</strong> — displays the file status:
<ul><li><strong>Infected</strong> — threat was detected after scanning. If a file was not cleaned after cleanup, the info icon is displayed. Hover mouse over info icon to display the reason.</li> <li><strong>Cleaned</strong> —  infected file is cleaned up.</li> <li><strong>Content removed</strong> — a file content was removed after cleanup.</li> <li><strong>Cleanup queued<sup>AV+</sup></strong> — infected file is queued for cleanup.
Actions:</li></ul></li> <li><strong>Add to Ignore List</strong> — add file to the Ignore List and remove it from the Malicious files list. Note that if a file is added to the Ignore List, ImunifyAV will no longer scan this file.</li> <li><strong>View file</strong> — click <em>eye</em> icon in the file line and the file content will be displayed in the pop-up. Only the first 100Kb of the file content will be shown in case if a file has bigger size.</li> <li><strong>Restore original</strong> — restore an initial infected file.</li> <li><strong>Cleanup file<sup>AV+</sup></strong> — click <em>Clean up</em> to clean up all infected files within the account.</li></ul> <p>To perform a bulk action, tick required users and click the corresponding button above the table.</p> <div class="danger custom-block"><p class="custom-block-title">Warning</p><p>Starting from ImunifyAV(+) v.5.5, the <em>Delete permanently</em> option is not available. Restoration from the Quarantine is available until the “Quarantine” Default Action is completely removed from the product (v.5.8, April 2021). You can still manage files in the quarantine if they were quarantined earlier. For more information see this <a href="https://blog.imunify360.com/file-quarantine-is-no-longer-effective" target="_blank" rel="noopener noreferrer">this blog post<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p></div><div class="tip custom-block"><p class="custom-block-title">Note</p><p>Cleaning up all files of all users is available in the ImunifyAV+. To upgrade to the ImunifyAV+, click <strong>Upgrade to ImunifyAV+</strong>, you will be redirected to <a href="/imunifyav/#upgrade">ImunifyAV+ upgrade</a> page. Or click <em>Cleanup all</em> button, you will be redirected to the <a href="/imunifyav/#upgrade">ImunifyAV+ upgrade</a> page.</p></div><p>The following filters are available:</p> <ul><li><strong>Scan date</strong> — displays the results filtered by chosen period or date.</li> <li><strong>Result</strong> — displays the results filtered by chosen status.</li> <li><strong>Total files</strong> – displays the results with descending/ascending filtering.</li> <li><strong>Items per page displayed</strong> — click the number at the table bottom.</li></ul> <p>The table can be sorted by detection date (detected), user name, file path (file), reason, and status.</p> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>Starting from ImunifyAV(+) v. 5.5, all filter and view options are stored in the browser's local storage so you can select filter preference options once and next time you'll open the tab, the options will be preset.</p></div><h3 id="scan"><a href="#scan" aria-hidden="true" class="header-anchor">#</a> Scan</h3> <p>Malware scanner allows users to scan a specific directory or file for malware. Go to ImunifyAV → Scan tab. Then proceed the following steps:</p> <ol><li>Type a folder name to scan in the <em>Folder to scan</em> field. Start typing with the slash <code>/</code>.
It is possible to use <em>Advanced</em> settings:</li></ol> <ul><li><strong>Filename mask</strong> allows to set file type for scanning (for example, <code>*.php</code> - all the files with the extension php). The default setting is <code>*</code> which means all files without restriction.</li> <li><strong>Ignore mask</strong> allows to set file type to ignore (for example, <code>*.html</code> will ignore all files with the extension html).</li> <li><span class="notranslate"><strong>CPU consumption</strong></span>. Defines the CPU consumption for scanning without decreasing efficiency: from <span class="notranslate">Low</span> to <span class="notranslate">High</span>.</li> <li><span class="notranslate"><strong>I/O consumption</strong></span>. Defines the I/O consumption for scanning without decreasing efficiency: from <span class="notranslate">Low</span> to <span class="notranslate">High</span>.</li> <li><span class="notranslate"><strong>Follow symlinks</strong></span>. Follow all symlinks within the folder to scan.</li></ul> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>If ImunifyAV is running on CloudLinux OS, LVE is used to manage scan intensity. If it is running on other operating systems, “nice” is used to control CPU and “ionice” is used when the I/O scheduler is CFQ.</p></div><ol start="2"><li>Click <em>Start</em>.</li></ol> <table><thead><tr><th style="text-align:center;"><img src="/images/AVMalwareScanner.png" alt=""></th></tr></thead> <tbody></tbody></table> <p>At the top right corner scanning progress and status are displayed:</p> <ul><li><strong>Scanner is stopped</strong> means that there is no scanning process running.</li> <li><strong>Scanning…%</strong> means that the scanner is working at the moment. A percentage displays the scanning progress. You can also see the scanning status beneath the <em>Mask</em> or <em>Advanced</em> options.</li></ul> <p>When scanning is completed, the results are shown in the table below with the following information:</p> <ul><li><strong>Date</strong> — scan date;</li> <li><strong>Path</strong> — scanned folder path;</li> <li><strong>Total files</strong> — total number of scanned files;</li> <li><strong>Result</strong> — displays a number of threats and a number of files detected as suspicious during scanning;</li> <li><strong>Action</strong>:
<ul><li><strong>View report</strong> — click <em>View Report</em> icon to go to the <em>Files</em> tab and display the results of the last scan.</li></ul></li></ul> <table><thead><tr><th style="text-align:center;"><img src="/images/hosterscantable_zoom70.png" alt=""></th></tr></thead> <tbody></tbody></table> <p>The following filters are available:</p> <p><strong>Timeframe</strong> — displays the results filtered by chosen period or date.
To review and manage suspicious files go to the <a href="/imunifyav/#files">Files</a> tab.</p> <p>The table can be sorted by Date, Path, Total files, and Result.</p> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>Starting from ImunifyAV(+) v. 5.5, all filter and view options are stored in the browser's local storage so you can select filter preference options once and next time you'll open the tab, the options will be preset.</p></div><table><thead><tr><th style="text-align:center;"><img src="/images/scan_filter.png" alt="Scan Filter" width="186" height="343"></th></tr></thead> <tbody></tbody></table> <h3 id="history"><a href="#history" aria-hidden="true" class="header-anchor">#</a> History</h3> <p>The <em>History</em> tab contains data of all actions for all files. Go to ImunifyAV → History tab. Here, there is a table with a list of files within all domains.</p> <table><thead><tr><th style="text-align:center;"><img src="/images/avhosterhistory_zoom70.png" alt=""></th></tr></thead> <tbody></tbody></table> <p>The table has the following columns:</p> <ul><li><strong>Date</strong> — action timestamp.</li> <li><strong>Path to File</strong> — path to the file starting from the root.</li> <li><strong>Cause</strong> — displays the way malicious file was found:
<ul><li><strong>Manual</strong> — scanning or cleaning was manually processed by a user.</li> <li><strong>On-demand</strong> — scanning or cleaning was initiated/made by a user.</li> <li><strong>Real time</strong> — scanning or cleaning was automatically processed by the system.</li></ul></li> <li><strong>Owner</strong> — displays a user name of a file owner.</li> <li><strong>Initiator</strong> — displays the name of a user who was initiated the action. For system actions the name is System.</li> <li><strong>Event</strong> — displays the action with the file:
<ul><li><strong>Detected as malicious</strong> — after scanning the file was detected as infected;</li> <li><strong>Cleaned</strong> — the file is cleaned up.</li> <li><strong>Failed to clean up</strong> — there was a problem during cleanup. Hover mouse over the info icon to read more.</li> <li><strong>Added to Ignore List</strong> — the file was added to the Ignore List. ImunifyAV will not scan it.</li> <li><strong>Restored original</strong> — file content was restored as not malicious.</li> <li><strong>Cleanup removed content</strong> — a file content was removed after cleanup.</li> <li><strong>Deleted from Ignore List</strong> — the file was removed from the Ignore List. ImunifyAV will scan it.</li> <li><strong>Deleted</strong> — the file was deleted.</li> <li><strong>Submitted for analysis</strong> — the file was submitted to the Imunify team for analysis.</li> <li><strong>Failed to ignore</strong> — there was a problem during adding to the Ignore List. Hover mouse over the info icon to read more.</li> <li><strong>Failed to delete from ignore</strong> — there was a problem during removal from the Ignore List. Hover mouse over the info icon to read more.</li></ul></li></ul> <p>The table can be sorted by Date, Path to File, Cause, and Owner.</p> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>Starting from ImunifyAV(+) v. 5.5, all filter and view options are stored in the browser's local storage so you can select filter preference options once and next time you'll open the tab, the options will be preset.</p></div><h3 id="ignore-list"><a href="#ignore-list" aria-hidden="true" class="header-anchor">#</a> Ignore List</h3> <p>The <em>Ignore List</em> tab contains the list of files that are excluded from Malware Scanner scanning. Go to ImunifyAV → Ignore List tab. Here, there is a table with a list of files within all domains.</p> <table><thead><tr><th style="text-align:center;"><img src="/images/AVIgnoreList.png" alt=""></th></tr></thead> <tbody></tbody></table> <p>The table has the following columns:</p> <ul><li><strong>Added</strong> — the date when the file was added to the Ignore list.</li> <li><strong>Path</strong> — path to the file starting from the root.</li> <li><strong>Actions</strong>:
<ul><li><strong>Remove from Ignore List</strong> — click <em>Bin</em> icon to remove the file from the Ignore list and start scanning.</li> <li><strong>Add new file or directory</strong> — click <em>Plus</em> icon to add a new file or directory to the Ignore list.
To perform a bulk action, tick the required files and click the corresponding button above the table.</li></ul></li></ul> <p>The following filters are available:</p> <p><strong>Timeframe</strong> — displays the results filtered by chosen period or date.
<strong>Items per page displayed</strong> — click the number at the table bottom.
<strong>Path</strong> – displays the results filtered by a path in a direct or reverse alphabetical order.</p> <p>The table can be sorted by Added and Path. By default, it is sorted from newest to oldest.</p> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>Starting from ImunifyAV(+) v. 5.5, all filter and view options are stored in the browser's local storage so you can select filter preference options once and next time you'll open the tab, the options will be preset.</p></div><h3 id="features-management"><a href="#features-management" aria-hidden="true" class="header-anchor">#</a> Features Management <span class="badge tip" style="vertical-align:top;" data-v-17014d78>AV+</span></h3> <p>Features Management tab allows to enable or disable ImunifyAV features for each customer. Go to ImunifyAV → Features Management tab.</p> <table><thead><tr><th style="text-align:center;"><img src="/images/AVFeaturesManagement.png" alt=""></th></tr></thead> <tbody></tbody></table> <p>To enable Malware Cleanup feature for new users by default, move the <em>Malware Cleanup</em> slider.</p> <p>The table has the following columns:</p> <ul><li><strong>Name</strong> — user name</li> <li><strong>Domains</strong> — user domain name</li> <li><strong>Malware Cleanup</strong> — allows to enable or disable Malware Cleanup feature for selected user by moving the slider.</li></ul> <p>To perform a bulk action, tick required users and move the <em>Malware Cleanup</em> slider at the table header. Confirm the action on the confirmation popup.</p> <h3 id="reputation-management"><a href="#reputation-management" aria-hidden="true" class="header-anchor">#</a> Reputation Management <span class="badge tip" style="vertical-align:top;" data-v-17014d78>AV+</span></h3> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>Reputation Management is available in ImunifyAV+ only.</p></div><p>Reputation Management is an analyzing and notifying tool intended to inform about websites blocking and blacklisting.</p> <p>Choose <em>Reputation Management</em> in the main menu of the ImunifyAV+ user interface to get to the Reputation Management page.</p> <p>Reputation Management allows to check if a domain registered on your server is safe or not based on the following reputation engines:</p> <ul><li><a href="https://safebrowsing.google.com/" target="_blank" rel="noopener noreferrer">Google Safe Browsing<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://tech.yandex.com/safebrowsing/" target="_blank" rel="noopener noreferrer">Yandex Safe Browsing<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.spamhaus.org/" target="_blank" rel="noopener noreferrer">Spamhaus<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.phishtank.com/" target="_blank" rel="noopener noreferrer">PhishTank<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://openphish.com/" target="_blank" rel="noopener noreferrer">OpenPhish<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</li></ul> <p>How does it work:</p> <ul><li>We get a list of domains periodically (via crontab)</li> <li>Send it to the central Imunify server</li> <li>Get results from it</li> <li>Add bad domains to the list of Reputation Management</li></ul> <p>If a domain or an IP is blocked, then this information will be available in the table below. If a user’s website appears in this table, then it would be useful to send <a href="https://developers.google.com/webmasters/hacked/" target="_blank" rel="noopener noreferrer">this link<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> to the user. This instruction can help to solve problems with the domain.</p> <p>At the top of the page (also in the main menu near Reputation Management item), ImunifyAV+ shows the number of affected domains. This number is a quantity of affected domains that exist on the server.</p> <p>The table shows:</p> <ul><li><em>ID</em> – domain owner username</li> <li><em>Domain</em> – the affected domain link</li> <li><em>Threat type</em> – read more about types <a href="https://developers.google.com/safe-browsing/v4/reference/rest/v4/ThreatType" target="_blank" rel="noopener noreferrer">on the link<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> (we still do not support THREAT_TYPE_UNSPECIFIED and POTENTIALLY_HARMFUL_APPLICATION)</li> <li><em>Vendor</em> – where the threat was detected</li> <li><em>Detection time</em> – exact time when the Reputation Management detected the domain</li> <li><em>Action</em> – a link to the actions guide</li></ul> <table><thead><tr><th style="text-align:center;"><img src="/images/AVReputationManagement1.png" alt=""></th></tr></thead> <tbody></tbody></table> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>Reputation Management online and browser look may differ. This is because Google Safe Browsing has an issue described on github.</p></div><div class="tip custom-block"><p class="custom-block-title">Note</p><p>Starting from ImunifyAV(+) v. 5.5, all filter and view options are stored in the browser's local storage so you can select filter preference options once and next time you'll open the tab, the options will be preset.</p></div><h3 id="settings"><a href="#settings" aria-hidden="true" class="header-anchor">#</a> Settings</h3> <p>Go to ImunifyAV → Settings tab to set up the behaviour of ImunifyAV scanner. Here you can configure the following:</p> <ul><li><a href="/imunifyav/#resource-consumption">Resource consumption</a></li> <li><a href="/imunifyav/#general">General</a></li> <li><a href="/imunifyav/#background-scanning">Background Scanning</a></li> <li><a href="/imunifyav/#malware-cleanup">Malware Cleanup</a></li> <li><a href="/imunifyav/#error-reporting">Error reporting</a></li> <li><a href="/imunifyav/#notifications">Notifications</a></li></ul> <h4 id="resource-consumption"><a href="#resource-consumption" aria-hidden="true" class="header-anchor">#</a> Resource consumption</h4> <table><thead><tr><th style="text-align:center;"><img src="/images/AVSettingsResourceConsumption.png" alt="ImunifyAV → Settings → Resource consumption"></th></tr></thead> <tbody></tbody></table> <ul><li><p><strong>CPU consumption</strong> – enables to set a level of CPU usage by Malware Scanner.</p> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>Low CPU usage means low scanning speed</p></div></li> <li><p><strong>I/O consumption</strong> – enables to set a level of I/O usage by Malware Scanner.</p> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>Low I/O usage means low scanning speed</p></div><div class="tip custom-block"><p class="custom-block-title">Note</p><p>If ImunifyAV is running on CloudLinux OS, LVE is used to manage scan intensity. If it is running on other operating systems, “nice” is used to control CPU and “ionice” is used when the I/O scheduler is CFQ.</p></div></li></ul> <h4 id="general"><a href="#general" aria-hidden="true" class="header-anchor">#</a> General</h4> <table><thead><tr><th style="text-align:center;"><img src="/images/AVSettingsGeneral.png" alt="ImunifyAV → Settings → General"></th></tr></thead> <tbody></tbody></table> <ul><li><strong>Automatically send suspicious and malicious files for analysis</strong> – malicious and suspicious files will be sent to the ImunifyAV Team for analysis automatically.</li> <li><strong>RapidScan</strong> – dramatically speeds up repeated scans based on smart re-scan approach, local result caching and cloud-assisted scan. When you first enable the RapidScan feature, the first scan will run as before. But subsequent scans will see a dramatic speed improvement, anywhere between 5 to 20 times faster. You can find the details here: <a href="https://docs.imunify360.com/features/#rapidscan" target="_blank" rel="noopener noreferrer">https://docs.imunify360.com/features/#rapidscan<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>)</li> <li><strong>Binary (ELF) malware detection</strong> – this option allows to scans user home directories for malware.</li></ul> <p>Tick required checkboxes and click the <em>Save changes</em> button.</p> <h4 id="background-scanning"><a href="#background-scanning" aria-hidden="true" class="header-anchor">#</a> Background Scanning</h4> <p>Allows to set up automatic, scheduled, background scanning of user accounts.</p> <ul><li><strong>Run scanning</strong> — select the desired period:
<ul><li>Never</li> <li>Daily*</li> <li>Weekly*</li> <li>Monthly</li></ul></li></ul> <div class="warning custom-block"><p class="custom-block-title">Note</p><p>The <code>Daily</code> and <code>Weekly</code> options are available for ImunifyAV+ and Imunify360 only.</p></div><table><thead><tr><th style="text-align:center;"><img src="/images/AVBackgroundScanning.png" alt="ImunifyAV → Settings → Background Scanning"></th></tr></thead> <tbody></tbody></table> <p>Depending on the selected period, precise settings.</p> <ul><li>If <em>Run scanning</em> is set to <em>Daily</em>, choose the exact time at the <em>Run at</em> dropdown.</li> <li>If <em>Run scanning</em> is set to <em>Weekly</em>, choose the day of the week at the <em>Run on</em> the dropdown and the exact time at the <em>Run at</em> dropdown.</li> <li>If <em>Run scanning</em> is set to <em>Monthly</em>, choose the day of the month at the <em>Day of month to run</em> dropdown and the exact time at the <em>Run at</em> dropdown.</li></ul> <h4 id="malware-cleanup"><a href="#malware-cleanup" aria-hidden="true" class="header-anchor">#</a> Malware Cleanup</h4> <ul><li><strong>Trim file instead of removal</strong> — do not remove infected file during cleanup but make the file zero-size (for malwares like web-shells);</li> <li><strong>Keep original files for … days</strong> — the original infected file is available for restore within the defined period. Default is 14 days.</li></ul> <table><thead><tr><th style="text-align:center;"><img src="/images/AVSettingsCleanup.png" alt=""></th></tr></thead> <tbody></tbody></table> <h4 id="error-reporting"><a href="#error-reporting" aria-hidden="true" class="header-anchor">#</a> Error reporting</h4> <p>Tick the <em>Enable Sentry error reporting</em> checkbox to send reports to ImunifyAV error reports server.</p> <table><thead><tr><th style="text-align:center;"><img src="/images/AVSettingsErrorReporting.png" alt=""></th></tr></thead> <tbody></tbody></table> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>Starting from ImunifyAV(+) v. 5.5, all filter and view options are stored in the browser's local storage so you can select filter preference options once and next time you'll open the tab, the options will be preset.</p></div><h3 id="upgrade"><a href="#upgrade" aria-hidden="true" class="header-anchor">#</a> Upgrade <span class="badge tip" style="vertical-align:top;" data-v-17014d78>AV</span></h3> <p>To upgrade to ImunifyAV+ click <em>Upgrade Imunify</em> button, upgrade page opens.</p> <p><img src="/images/avhosterupgrade_zoom70.png" alt=""></p> <p>To upgrade, click <em>Buy Now</em> button, you will be redirected to the purchase page. Or activate the product using an activation key if you already have one.</p> <h2 id="end-user-interface"><a href="#end-user-interface" aria-hidden="true" class="header-anchor">#</a> End User Interface</h2> <p>The user side is hidden by default and can be enabled by executing the following command:</p> <div class="language- extra-class"><pre class="language-text"><code>/usr/share/av-userside-plugin.sh
</code></pre></div><p>To disable it back, run:</p> <div class="language- extra-class"><pre class="language-text"><code>/usr/share/av-userside-plugin.sh -r
</code></pre></div><p>Click <em>ImunifyAV</em> in the main menu. There are following tabs in ImunifyAV end user interface:</p> <ul><li><a href="/imunifyav/#files-2">Files</a></li> <li><a href="/imunifyav/#history-2">History</a></li> <li><a href="/imunifyav/#ignore-list-2">Ignore List</a></li></ul> <h3 id="files-2"><a href="#files-2" aria-hidden="true" class="header-anchor">#</a> Files</h3> <p>Go to ImunifyAV → Files tab. Here, there is a table with a list of infected files.</p> <table><thead><tr><th style="text-align:center;"><img src="/images/AVUIFiles.png" alt="ImunifyAV Hoster UI → Files tab"></th></tr></thead> <tbody></tbody></table> <p>The table has the following columns:</p> <ul><li><strong>Scan date</strong> — displays the exact time when a file was detected as malicious</li> <li><strong>File</strong> — the path where the file is located starting with root</li> <li><strong>Reason</strong> — describes the signature which was detected during the scanning process. Names in this column depend on the signature vendor. You can derive some information from the signature ID itself. <code>SMW-SA-05155-wshll</code> – in this Signature ID:
<ul><li>The first section can be either <code>SMW</code> or <code>CMW</code>. <code>SMW</code> stands for Server Malware and <code>CMW</code> stands for Client Malware</li> <li>The second section of ID can be either <code>INJ</code> or <code>SA</code>. <code>INJ</code> stands for Injection (means Malware is Injected to some legitimate file) and <code>SA</code> stands for StandAlone (means File is Completely Malicious)</li> <li>The third section is <code>05155</code>. This is simply an identification number for the signature.</li> <li>The fourth section <code>wshll/mlw.wp/etc</code> explains the category and class of malware identified. Here, <code>wshll</code> stands for web shell (<code>mlw</code> stands for malware).</li> <li>The fifth section is <code>0</code>, which provides the version number of the signature.</li></ul></li> <li><strong>Status</strong> — displays the file status:
<ul><li><strong>Infected</strong> — threat was detected after scanning. If a file was not cleaned after cleanup, the info icon is displayed. Hover mouse over info icon to display the reason</li> <li><strong>Cleaned</strong> — infected file is cleaned up</li> <li><strong>Content removed</strong> — a file content was removed after cleanup</li> <li><strong>Cleanup queued<sup> AV+</sup></strong> — infected file is queued for cleanup.</li></ul></li> <li><strong>Actions</strong>:
<ul><li><strong>Add to Ignore List</strong> — add file to Ignore List and remove it from the Malicious files list. Note that if a file is added to Ignore List, ImunifyAV will no longer scan this file</li> <li><strong>View file</strong> — click <em>eye</em> icon in the file line and the file content will be displayed in the popup. Only the first 100Kb of the file content will be shown in case if a file has bigger size</li> <li><strong>Cleanup<sup> AV+</sup></strong> — click to cleanup the file.</li> <li><strong>Delete<sup> AV+</sup></strong> — remove the file from the server and from the list of Malicious files.</li> <li><strong>Restore original<sup> AV+</sup></strong> — click <em>Restore original</em> to restore original file after cleaning up if backup is available.</li></ul></li></ul> <p>To perform a bulk action, tick required users and click the corresponding button above the table.</p> <p>If a user is allowed by the administrator to run a scan at any time on his own, he can see the <em>Start scanning</em> button.</p> <p>The following filters are available:</p> <ul><li><strong>Timeframe</strong> — displays the results filtered by chosen period or date.</li> <li><strong>Status</strong> — displays the results filtered by chosen status.</li> <li><strong>Items per page displayed</strong> — click the number at the table bottom.</li></ul> <p>The table can be sorted by detection date (Detected), file path (File), Reason, and Status.</p> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>Starting from ImunifyAV(+) v. 5.5, all filter and view options are stored in the browser's local storage so you can select filter preference options once and next time you'll open the tab, the options will be preset.</p></div><p>If a user is allowed by an administrator to scan his files, he can see the <em>Start scanning</em> button. See also: <a href="/faq_and_known_issues/#how-to-enable-disable-the-start-scanning-button-for-imunifyav-av">How to enable/disable the &quot;Start scanning&quot; button for ImunifyAV\AV+</a>.</p> <p><img src="/images/StartScanningAV.png" alt=""></p> <h3 id="history-2"><a href="#history-2" aria-hidden="true" class="header-anchor">#</a> History</h3> <p>History tab contains data of all actions for all files. Go to ImunifyAV → History tab. Here, there is a table with a list of files.</p> <p><img src="/images/avhistoryuser_zoom70.png" alt=""></p> <p>The table has the following columns:</p> <ul><li><strong>Date</strong> — action timestamp.</li> <li><strong>Path to File</strong> — path to the file starting from the root.</li> <li><strong>Cause</strong> — displays the way malicious file was found:
<ul><li><strong>Manual</strong> — scanning or cleaning was manually processed by a user.</li> <li><strong>On-demand</strong> — scanning or cleaning was initiated/made by a user;</li> <li><strong>Real time</strong> — scanning or cleaning was automatically processed by the system.</li></ul></li> <li><strong>Owner</strong> — displays a user name of file owner.</li> <li><strong>Initiator</strong> — displays the name of a user who was initiated the action. For system actions the name is System.</li> <li><strong>Event</strong> — displays the action with the file:
<ul><li><strong>Detected as malicious</strong> — after scanning the file was detected as infected;</li> <li><strong>Cleaned</strong> — the file is cleaned up.</li> <li><strong>Failed to clean up</strong> — there was a problem during cleanup. Hover mouse over the info icon to read more.</li> <li><strong>Added to Ignore List</strong> — the file was added to Ignore List. ImunifyAV will not scan it.</li> <li><strong>Restored original</strong> — file content was restored as not malicious.</li> <li><strong>Cleanup removed content</strong> — file contend was removed after cleanup.</li> <li><strong>Deleted from Ignore List</strong> — the file was removed from Ignore List. ImunifyAV will scan it.</li> <li><strong>Deleted</strong> — the file was deleted.</li> <li><strong>Submitted for analysis</strong> — the file was submitted to Imunify team for analysis.</li> <li><strong>Failed to delete</strong> — there was a problem during removal. Hover mouse over the info icon to read more.</li> <li><strong>Failed to ignore</strong> — there was a problem during adding to Ignore List. Hover mouse over the info icon to read more.</li> <li><strong>Failed to delete from ignore</strong> — there was a problem during removal from Ignore List. Hover mouse over the info icon to read more.</li></ul></li></ul> <p>The table can be sorted by Date, Path to File, Cause, and Owner.</p> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>Starting from ImunifyAV(+) v. 5.5, all filter and view options are stored in the browser's local storage so you can select filter preference options once and next time you'll open the tab, the options will be preset.</p></div><h3 id="ignore-list-2"><a href="#ignore-list-2" aria-hidden="true" class="header-anchor">#</a> Ignore List</h3> <p>Ignore List tab contains the list of files that are excluded from Malware Scanner scanning. Go to ImunifyAV → Ignore List tab. Here, there is a table with a list of files.</p> <p><img src="/images/avignorelistuser_zoom70.png" alt=""></p> <p>The table has the following columns:</p> <ul><li><strong>Added</strong> — the date when the file was added to Ignore List.</li> <li><strong>Path</strong> — path to the file starting from the root.</li> <li><strong>Actions</strong>:
<ul><li><strong>Remove from Ignore List</strong> — click <em>Bin</em> icon to remove the file from the Ignore List and start scanning.</li> <li><strong>Add new file or directory</strong> — click <em>Plus</em> icon to add a new file or directory to Ignore List.
To perform a bulk action, tick required files and click the corresponding button above the table.</li></ul></li></ul> <p>The following filters are available:</p> <ul><li><strong>Timeframe</strong> — displays the results filtered by chosen period or date.</li> <li><strong>Items per page displayed</strong> — click the number at the table bottom.</li></ul> <p>The table can be sorted by Added and Path. By default, it is sorted from newest to oldest.</p> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>Starting from ImunifyAV(+) v. 5.5, all filter and view options are stored in the browser's local storage so you can select filter preference options once and next time you'll open the tab, the options will be preset.</p></div><h2 id="hooks"><a href="#hooks" aria-hidden="true" class="header-anchor">#</a> Hooks <span class="badge warning" style="vertical-align:top;" data-v-17014d78>Deprecated</span></h2> <div class="danger custom-block"><p class="custom-block-title">Warning!</p><p>You can use a new notification system via <a href="/cli/#notifications-config">CLI</a>.</p></div><h3 id="overview"><a href="#overview" aria-hidden="true" class="header-anchor">#</a> Overview</h3> <p>Hooks are introduced as a script-based interface for various application events. This is a simple and effective way to automate ImunifyAV alerts and event processing.
For example, an administrator can have ImunifyAV calling his own script when malicious files are detected or misconfigurations are detected and perform a custom processing or specific actions, for example, create a ticket.
Hooks are available only via CLI.</p> <p><strong>Requirements</strong></p> <ul><li>You can use any programming language to create a hook script</li> <li>A hook script should be executable</li> <li>For Native hooks, you should use Python 3.5 only</li></ul> <h3 id="how-to-start-using-hooks"><a href="#how-to-start-using-hooks" aria-hidden="true" class="header-anchor">#</a> How to start using hooks</h3> <p>Start using hooks with three simple steps:</p> <ol><li>Create a script to handle an event (a hook handler):</li></ol> <ul><li>you can use our <a href="/imunifyav/#structure-and-examples-of-a-hook-script">scripts example</a> as a template</li> <li><a href="/imunifyav/#available-events-and-their-parameters">the following events are available</a></li></ul> <ol start="2"><li>Register your hook handler in ImunifyAV agent - use registration command:</li></ol> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify-antivirus hook add --event &lt;event name&gt; --path &lt;/path/to/hook_script&gt;
</code></pre></div></div> <ol start="3"><li>Once the event added - check results and the log file (see below)</li></ol> <h3 id="available-events-and-their-parameters"><a href="#available-events-and-their-parameters" aria-hidden="true" class="header-anchor">#</a> Available events and their parameters</h3> <ul><li><p><strong>agent</strong></p> <ul><li>subtype ( started | misconfig )
<ul><li>started - the event is generated each time the Imunify agent is started/restarted
<ul><li>params[]
<ul><li>version / string / version of agent</li></ul></li></ul></li> <li>misconfig - the event is generated when the agent detects agent misconfiguration / broken settings / etc.
<ul><li>params[]
<ul><li>error / string / error message where / what type of misconfiguration was detected and some details</li></ul></li></ul></li></ul></li></ul></li> <li><p><strong>malware-scanning</strong></p> <ul><li>subtype ( started | finished )
<ul><li>started - the event is generated when the malware scanning process is started (for on-demand and background scans only, yet not the ftp / waf / inotify)
<ul><li>params[]
<ul><li>scan_id / string / identifier of running scan</li> <li>path / string / path that’s scanning</li> <li>type / string / type of scanning (“on-demand”, “background”, “ftp”)</li> <li>scan_params[]  / initial scanning params
<ul><li>file_mask / string / file mask to scan</li> <li>follow_symlinks / boolean / shall scanner follow symlinks</li> <li>ignore_mask / string / file mask to ignore</li> <li>intensity / string / intensity type selected (“low”, “moderate”,  “high”)</li></ul></li></ul></li></ul></li></ul></li></ul></li></ul> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>{
&quot;scan_id&quot;:&quot;dc3c6061c572410a83be19d153809df1&quot;,
&quot;home&quot;:&quot;/home/a/abdhf/&quot;,
&quot;user&quot;:&quot;abdhf&quot;,
&quot;type&quot;:&quot;background&quot;,
&quot;scan_params&quot;: {&quot;file_mask&quot;:&quot;*&quot;, &quot;follow_symlinks&quot;:&quot;true&quot;, &quot;ignore_mask&quot;:&quot;&quot;, &quot;intensity&quot;:&quot;low&quot;}
}
</code></pre></div></div> <ul><li><ul><li><ul><li>finished - the event is generated when the malware scanning process is finished (for on-demand and background scans only, yet not the ftp / waf / inotify)
<ul><li>params[]
<ul><li>scan_id / string / identifier of running scan</li> <li>path / string / path that’s scanned</li> <li>users[] / string array/ user that’s scanned</li> <li>started / int / unixtime when scan started</li> <li>total_files / int / total number of files that were scanned</li> <li>total_malicious / int / number of detected malicious files</li> <li>errors[] / string / error message if any occurred during scanning</li> <li>status / string / status of scan (“ok”, “has_errors”, “failed”)</li> <li>scan_params[] / initial scanning params
<ul><li>file_mask / string / file mask to scan</li> <li>follow_symlinks / boolean / shall scanner follow symlinks</li> <li>ignore_mask / string / file mask to ignore</li> <li>intensity / string / intensity type selected (“low”, “moderate”,  “high”)</li></ul></li></ul></li></ul></li></ul></li></ul></li></ul> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>{
&quot;scan_id&quot;:&quot;dc3c6061c572410a83be19d153809df1&quot;,
&quot;home&quot;:&quot;/home/a/abdhf/&quot;,
&quot;user&quot;:&quot;abdhf&quot;,
&quot;started&quot;:1587365282,
&quot;total_files&quot;:873535,
&quot;total_malicious&quot;:345,
&quot;errors&quot;:[],
&quot;status&quot;:&quot;ok&quot;,
&quot;type&quot;:&quot;background&quot;,
&quot;scan_params&quot;: {&quot;file_mask&quot;:&quot;*&quot;, &quot;follow_symlinks&quot;:&quot;true&quot;, &quot;ignore_mask&quot;:&quot;&quot;, &quot;intensity&quot;:&quot;low&quot;}
}
</code></pre></div></div> <ul><li><strong>malware-detected</strong> <ul><li>subtype ( critical )
<ul><li>critical
<ul><li>params[]
<ul><li>scan_id / string / unique id of the scan</li> <li>errors[] / string / error strings that happened during the last scan</li> <li>started / int / unixtime when the scan was started</li> <li>path / string / path that was scanned</li> <li>users[] / string array / users that have been scanned (if any)</li> <li>total_files / int / number of files checked within the last scanning</li> <li>total_malicious / int / number of detected malicious files</li> <li>tmp_filename / string / path to a temporary file with a list of detected threads. The list of threads is in the format of the following command: <span class="notranslate"><code>imunify-antivirus malware malicious list --by-scan-id=... --json</code></span></li></ul></li></ul></li></ul></li></ul></li></ul> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>{

&quot;scan_id&quot;:&quot;dc3c6061c572410a83be19d153809df1&quot;,
&quot;path&quot;:&quot;/home/a/abdhf/&quot;,
&quot;username&quot;:[&quot;imunify&quot;],
&quot;started&quot;:1587365282,
&quot;total_files&quot;:873535,
&quot;total_malicious&quot;:345,
&quot;errors&quot;:[],
&quot;files&quot;:[
{
  &quot;username&quot;:&quot;imunify&quot;,
  &quot;hash&quot;:&quot;17c1dd3659578126a32701bb5eaccecc2a6d8307d8e392f5381b7273bfb8a89d&quot;,
  &quot;size&quot;:&quot;182&quot;,
  &quot;cleaned_at&quot;:1553762878.6882641,
  &quot;extra_data&quot;:{


  },
  &quot;malicious&quot;:true,
  &quot;id&quot;:32,
  &quot;status&quot;:&quot;cleanup_removed&quot;,
  &quot;file&quot;:&quot;/home/imunify/public_html/01102018_2.php&quot;,
  &quot;type&quot;:&quot;SMW-INJ-04174-bkdr&quot;,
  &quot;scan_type&quot;:&quot;on-demand&quot;,
  &quot;Created&quot;:1553002672
},
{
  &quot;username&quot;:&quot;imunify&quot;,
  &quot;hash&quot;:&quot;04425f71ae6c3cd04f8a7f156aee57096dd658ce6321c92619a07e122d33bd32&quot;,
  &quot;size&quot;:&quot;12523&quot;,
  &quot;cleaned_at&quot;:1553762878.6882641,
  &quot;extra_data&quot;:{


  },
  &quot;malicious&quot;:true,
  &quot;id&quot;:33,
  &quot;status&quot;:&quot;cleanup_done&quot;,
  &quot;file&quot;:&quot;/home/imunify/public_html/22.js&quot;,
  &quot;type&quot;:&quot;SMW-INJ-04346-js.inj&quot;,
  &quot;scan_type&quot;:&quot;on-demand&quot;,
  &quot;Created&quot;:1553002672
},
...

}
</code></pre></div></div> <div class="tip custom-block"><p class="custom-block-title">Note</p><p>All results can be saved in a temporary file before handler invocation and then remove the file after the event is being processed</p></div><ul><li><strong>malware-cleanup</strong> <ul><li>subtype ( started | finished )
<ul><li>started - the event is generated when the malware cleanup process is started (for on-demand and background cleanup only, background auto-cleanup will be implemented later)
<ul><li>params[]
<ul><li>cleanup_id / string / unique id of the cleanup</li> <li>started / int / unixtime when the cleanup was started</li> <li>tmp_filename / string / path to a temporary file with a scanning report. The list is in the format of the following command: <span class="notranslate"><code>imunify-antivirus malware malicious list --by-scan-id=... --json</code></span> . See malware-detected hook section for details.</li> <li>total_files / int / number of files that were sent for cleanup</li></ul></li></ul></li> <li>finished - the event is generated when the malware scanning process is finished (for on-demand and background cleanup only, background auto-cleanup will be implemented later)
<ul><li>params[]
<ul><li>cleanup_id / string / identifier of running cleanup</li> <li>started / int / unixtime when cleanup started</li> <li>total_files / int / number of files that were sent for cleanup</li> <li>total_cleaned / int / number of files that were successfully cleaned</li> <li>tmp_filename / string / path to a temporary file with a list of results.</li> <li>errors[] / string / error messages if any occurred during cleanup</li> <li>errors[] / string / error messages if any occurred during cleanup</li></ul></li></ul></li></ul></li></ul></li></ul> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>{
&quot;scan_id&quot;:&quot;dc3c6061c572410a83be19d153809df1&quot;,
&quot;started&quot;:1587365282,
&quot;total_files&quot;:873535,
&quot;total_cleaned&quot;:872835,
&quot;tmp_filename&quot;:”/var/imunify/tmp/hooks/tmp_02q648234692834698456728439587245.json”,
&quot;errors&quot;:[],
&quot;status&quot;:&quot;ok&quot;
}
</code></pre></div></div> <h3 id="hooks-cli"><a href="#hooks-cli" aria-hidden="true" class="header-anchor">#</a> Hooks CLI</h3> <p>The following CLI command is used to manage hooks:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>imunify-antivirus hook [command] --event [event_name|all] [--path &lt;/path/to/hook_script&gt;]
</code></pre></div></div> <p>The following commands are supported:</p> <ul><li><span class="notranslate"><strong>add</strong></span> - register a new event handler</li> <li><span class="notranslate"><strong>delete</strong></span> - unregister existing event handler</li> <li><span class="notranslate"><strong>list</strong></span> - show existing event handlers</li> <li><span class="notranslate"><strong>add-native</strong></span> - register a new native event handler</li></ul> <p>The third parameter <span class="notranslate"><em>event_name</em></span> defines a particular event that invokes a registered handler as opposed to <span class="notranslate"><strong>all</strong></span> keyword.<br>
The fourth parameter <code>/path/to/hook_script</code> shall contain a valid path to a handler of the event, it shall be any executable or Python Native event handlers that agent will run upon a registered event.</p> <p><strong>Native</strong></p> <p>Native hook is a script written on Python 3.5 and allows to quickly process events. The Python file should contain only one method that customer would implement:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>def im_hook(dict_param):
	….
	pass
</code></pre></div></div> <p>where <code>dict_param</code> would hold the same data as JSON that non-Native hook will gate.</p> <p><strong>Log File</strong></p> <p>You can see all hook data in the log file. It is located at <span class="notranslate"><em>/var/log/imunify360/hook.log</em></span> .
When the event comes, the data is recorded to the log file in the following format:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>timestamp event : id : started [native:] name :  subtype : script_path
</code></pre></div></div> <ul><li><span class="notranslate"><strong>native</strong></span> is prepended for the Native hook implementation</li> <li><span class="notranslate"><strong>id</strong></span> is a unique ID for each event</li></ul> <p>Once the listener is done, the data is recorded to the log file in the following format:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>timestamp event : id : done [native:] script_path [OK|ERROR:code]
</code></pre></div></div> <p>In case of an error, you can see the error code you have specified.</p> <h3 id="structure-and-examples-of-a-hook-script"><a href="#structure-and-examples-of-a-hook-script" aria-hidden="true" class="header-anchor">#</a> Structure and examples of a hook script</h3> <p>Regular (non-native) hook:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>#!/bin/bash

data=$(cat)

event=$(jq -r '.event' &lt;&lt;&lt; ${data})
subtype=$(jq -r '.subtype' &lt;&lt;&lt; ${data})

case ${event} in
    malware-scanning)
        case ${subtype} in
            started)
                # do stuff here
            ;;
            *)
                echo &quot;Unhandled subtype: ${subtype}&quot; 1&gt;&amp;2
                exit 1
        esac
        ;;
    *)
        echo &quot;Unhandled event: ${event}/${subtype}&quot; 1&gt;&amp;2
        exit 2
esac
</code></pre></div></div> <p>Native hook:</p> <div class="notranslate"><div class="language- extra-class"><pre class="language-text"><code>def im_hook(dict_param):
   event = dict_param['event']
   subtype = dict_param['subtype']

   if event == 'malware-scanning':
       if subtype == 'started':
           # do stuff here
           pass
       elif subtype == 'finished':
           # do other stuff here
           pass
       else:
           raise Exception('Unhandled subtype {}'.format(subtype))
   else:
       raise Exception('Unhandled event {}'.format(event))
</code></pre></div></div> <h3 id="notifications"><a href="#notifications" aria-hidden="true" class="header-anchor">#</a> Notifications</h3> <p>Starting from version 5.1, ImunifyAV/AV+ provides a completely new Hooks system configuration. Hooks can be configured via the separate UI “Notifications” tab in the Settings, or via the command-line interface (CLI).</p> <p><img src="/images/SettingsNotificationsAV.png" alt=""></p> <p>The administrator can configure to execute custom scripts (“hook handler”). Also, hooks support a new set of events and notification types:</p> <ul><li>Events occurring in each type of scan (real-time scan, user account scan, custom folder scan)</li> <li>Events occurring at different stages of malware scanning process: upon scanning start, finish, when malware is found</li></ul> <p>Each hook can be configured from the UI and the <a href="/cli/">CLI</a>. Each hook type has the enable/disable toggle and event handler script.</p> <div class="tip custom-block"><p class="custom-block-title">Notes</p><ul><li>The hook script field accepts a fully qualified path</li> <li>The hook script requires “execution” (+x) permissions to be set to work</li> <li>Email notifications available in Imunify360</li></ul></div></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/cloudlinux/imunifyav-doc/edit/dev/docs/imunifyav/README.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> <div class="back-to-top" data-v-5366e0dd><a href="/imunifyav/#app" class="nav-arrow top back-to-top__link" data-v-5366e0dd></a></div> </div> <div class="footer" data-v-3ca314c6><div data-v-3ca314c6><a href="https://cloudlinux.com" data-v-3ca314c6><img src="/assets/img/we-are-cloudlinux.783ed390.svg" alt="We are Cloudlinux" data-v-3ca314c6></a></div> <div class="footer-company-title" data-v-3ca314c6>2021. CloudLinux Inc</div> <div data-v-3ca314c6><div data-v-3ca314c6><a href="https://cloudlinux.zendesk.com/hc/en-us/articles/360011750114-ImunifyAV-AV-FAQ" target="_blank" data-v-3ca314c6>FAQ</a></div><div data-v-3ca314c6><a href="https://www.imunify360.com/antivirus" target="_blank" data-v-3ca314c6>Getting started</a></div><div data-v-3ca314c6><a href="https://cloudlinux.zendesk.com/hc/requests/new" target="_blank" data-v-3ca314c6>Contact support</a></div><div data-v-3ca314c6><a href="https://blog.imunify360.com/tag/imunifyav" target="_blank" data-v-3ca314c6>Blog</a></div></div> <div class="social" data-v-3ca314c6><span class="footer-social-text" data-v-3ca314c6></span> <a href="https://www.facebook.com/imunify360/" target="_blank" data-v-3ca314c6><img src="/fb.png" class="footer-social-logo" data-v-3ca314c6></a><a href="https://twitter.com/imunify360/" target="_blank" data-v-3ca314c6><img src="/tw.png" class="footer-social-logo" data-v-3ca314c6></a><a href="https://linkedin.com/company/cloudlinux" target="_blank" data-v-3ca314c6><img src="/in.png" class="footer-social-logo" data-v-3ca314c6></a><a href="https://www.youtube.com/channel/UCcW6dDJjcy41c7Hl_5LdLZQ" target="_blank" data-v-3ca314c6><img src="/ytube.png" class="footer-social-logo" data-v-3ca314c6></a></div></div> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.6629b37e.js" defer></script><script src="/assets/js/4.5c949845.js" defer></script><script src="/assets/js/1.617ab414.js" defer></script><script src="/assets/js/26.6a906275.js" defer></script><script src="/assets/js/19.aba410b3.js" defer></script>
  </body>
</html>
